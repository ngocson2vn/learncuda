<!DOCTYPE html> <html lang=en-US style><!--
 Page saved with SingleFile 
 url: https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/ 
 saved date: Thu Nov 21 2024 06:30:43 GMT+0800 (Singapore Standard Time)
--><meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1">
<meta name=robots content=max-image-preview:large>
<meta name=dlm-version content=5.0.14><title>CUTLASS Tutorial: Fast Matrix-Multiplication with WGMMA on NVIDIA® Hopper™ GPUs – Colfax Research</title>
<link rel=alternate type=application/rss+xml title="Colfax Research » Feed" href=https://research.colfax-intl.com/feed/>
<link rel=alternate type=application/rss+xml title="Colfax Research » Comments Feed" href=https://research.colfax-intl.com/comments/feed/>
<link rel=alternate type=application/rss+xml title="Colfax Research » CUTLASS Tutorial: Fast Matrix-Multiplication with WGMMA on NVIDIA® Hopper™ GPUs Comments Feed" href=https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/feed/>
<style>:root{--sf-img-10: url("data:image/jpeg;base64,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")}</style><style>@media only screen and (max-width:640px){}@media only screen and (max-width:640px){}@media only screen and (max-width:320px){}</style>
<style>.wp-block-image img{box-sizing:border-box;height:auto;max-width:100%;vertical-align:bottom}@media (prefers-reduced-motion:no-preference){}.wp-block-image :where(figcaption){margin-bottom:1em;margin-top:.5em}@supports ((-webkit-mask-image:none) or (mask-image:none)) or (-webkit-mask-image:none){.wp-block-image.is-style-circle-mask img{border-radius:0;-webkit-mask-image:url(data:image/svg+xml;utf8,<svg\ viewBox=\"0\ 0\ 100\ 100\"\ xmlns=\"http://www.w3.org/2000/svg\"><circle\ cx=\"50\"\ cy=\"50\"\ r=\"50\"\/><\/svg>);mask-image:url(data:image/svg+xml;utf8,<svg\ viewBox=\"0\ 0\ 100\ 100\"\ xmlns=\"http://www.w3.org/2000/svg\"><circle\ cx=\"50\"\ cy=\"50\"\ r=\"50\"\/><\/svg>);mask-mode:alpha;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain}}:root :where(.wp-block-image.is-style-rounded img,.wp-block-image .is-style-rounded img){border-radius:9999px}@media (prefers-reduced-motion:no-preference){}@keyframes show-content-image{0%{visibility:hidden}99%{visibility:hidden}to{visibility:visible}}@keyframes turn-on-visibility{0%{opacity:0}to{opacity:1}}@keyframes turn-off-visibility{0%{opacity:1;visibility:visible}99%{opacity:0;visibility:visible}to{opacity:0;visibility:hidden}}@keyframes lightbox-zoom-in{0%{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale))}to{transform:translate(-50%,-50%) scale(1)}}@keyframes lightbox-zoom-out{0%{transform:translate(-50%,-50%) scale(1);visibility:visible}99%{visibility:visible}to{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale));visibility:hidden}}</style>
<style id=wp-block-navigation-link-inline-css>.wp-block-navigation .wp-block-navigation-item__label{overflow-wrap:break-word}</style>
<style>.wp-block-navigation{position:relative;--navigation-layout-justification-setting:flex-start;--navigation-layout-direction:row;--navigation-layout-wrap:wrap;--navigation-layout-justify:flex-start;--navigation-layout-align:center}.wp-block-navigation ul{margin-bottom:0;margin-left:0;margin-top:0;padding-left:0}.wp-block-navigation ul,.wp-block-navigation ul li{list-style:none;padding:0}.wp-block-navigation .wp-block-navigation-item{align-items:center;background-color:inherit;display:flex;position:relative}.wp-block-navigation .wp-block-navigation-item .wp-block-navigation__submenu-container:empty{display:none}.wp-block-navigation .wp-block-navigation-item__content{display:block}.wp-block-navigation .wp-block-navigation-item__content.wp-block-navigation-item__content{color:inherit}.wp-block-navigation :where(a),.wp-block-navigation :where(a:active),.wp-block-navigation :where(a:focus){text-decoration:none}.wp-block-navigation .wp-block-navigation__submenu-icon{align-self:center;background-color:inherit;border:none;color:currentColor;display:inline-block;font-size:inherit;height:.6em;line-height:0;margin-left:.25em;padding:0;width:.6em}.wp-block-navigation .wp-block-navigation__submenu-icon svg{display:inline-block;height:inherit;margin-top:.075em;width:inherit}.wp-block-navigation .has-child .wp-block-navigation__submenu-container{align-items:normal;background-color:inherit;color:inherit;display:flex;flex-direction:column;height:0;left:-1px;opacity:0;overflow:hidden;position:absolute;top:100%;transition:opacity .1s linear;visibility:hidden;width:0;z-index:2}.wp-block-navigation .has-child .wp-block-navigation__submenu-container>.wp-block-navigation-item>.wp-block-navigation-item__content{display:flex;flex-grow:1}.wp-block-navigation .has-child .wp-block-navigation__submenu-container .wp-block-navigation-item__content{margin:0}@media (min-width:782px){}.wp-block-navigation .has-child .wp-block-navigation-submenu__toggle[aria-expanded=true]~.wp-block-navigation__submenu-container,.wp-block-navigation .has-child:not(.open-on-click):hover>.wp-block-navigation__submenu-container,.wp-block-navigation .has-child:not(.open-on-click):not(.open-on-hover-click):focus-within>.wp-block-navigation__submenu-container{height:auto;min-width:200px;opacity:1;overflow:visible;visibility:visible;width:auto}@media (min-width:782px){}.wp-block-navigation-submenu .wp-block-navigation__submenu-icon svg{stroke:currentColor}.wp-block-navigation-submenu__toggle{cursor:pointer}.wp-block-navigation__responsive-close,.wp-block-navigation__responsive-container,.wp-block-navigation__responsive-container-content,.wp-block-navigation__responsive-dialog{gap:inherit}:where(.wp-block-navigation.has-background .wp-block-navigation-item a:not(.wp-element-button)),:where(.wp-block-navigation.has-background .wp-block-navigation-submenu a:not(.wp-element-button)){padding:.5em 1em}:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-item a:not(.wp-element-button)),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-submenu a:not(.wp-element-button)),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-submenu button.wp-block-navigation-item__content),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-pages-list__item button.wp-block-navigation-item__content){padding:.5em 1em}@media (min-width:782px){}.wp-block-navigation:not(.has-background) .wp-block-navigation__submenu-container{background-color:#fff;border:1px solid #00000026}.wp-block-navigation:not(.has-text-color) .wp-block-navigation__submenu-container{color:#000}.wp-block-navigation__container{align-items:var(--navigation-layout-align,initial);display:flex;flex-direction:var(--navigation-layout-direction,initial);flex-wrap:var(--navigation-layout-wrap,wrap);justify-content:var(--navigation-layout-justify,initial);margin:0}.wp-block-navigation__container:only-child,.wp-block-page-list:only-child{flex-grow:1}@keyframes overlay-menu__fade-in-animation{0%{opacity:0;transform:translateY(.5em)}to{opacity:1;transform:translateY(0)}}.wp-block-navigation__responsive-container{bottom:0;display:none;left:0;position:fixed;right:0;top:0}.wp-block-navigation__responsive-container :where(.wp-block-navigation-item a){color:inherit}.wp-block-navigation__responsive-container .wp-block-navigation__responsive-container-content{align-items:var(--navigation-layout-align,initial);display:flex;flex-direction:var(--navigation-layout-direction,initial);flex-wrap:var(--navigation-layout-wrap,wrap);justify-content:var(--navigation-layout-justify,initial)}.wp-block-navigation__responsive-container:not(.is-menu-open.is-menu-open){background-color:inherit!important;color:inherit!important}@media (prefers-reduced-motion:reduce){}@media (min-width:600px){.wp-block-navigation__responsive-container:not(.hidden-by-default):not(.is-menu-open){background-color:inherit;display:block;position:relative;width:100%;z-index:auto}}.wp-block-navigation__responsive-container-close svg,.wp-block-navigation__responsive-container-open svg{fill:currentColor;display:block;height:24px;pointer-events:none;width:24px}@media (min-width:600px){}.wp-block-navigation__responsive-close{width:100%}.wp-block-navigation__responsive-close:focus{outline:none}.wp-block-navigation__responsive-dialog{position:relative}@media (min-width:782px){}</style>
<style id=wp-block-group-inline-css>.wp-block-group{box-sizing:border-box}:where(.wp-block-group.wp-block-group-is-layout-constrained){position:relative}</style>
<style id=wp-block-paragraph-inline-css>:root :where(p.has-background){padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}</style>
<style id=wp-block-search-inline-css>.wp-block-search__button{margin-left:10px;word-break:normal}.wp-block-search__button.has-icon{line-height:0}.wp-block-search__button svg{width:1.25em;fill:currentColor;vertical-align:text-bottom}:where(.wp-block-search__button){border:1px solid #ccc;padding:6px 10px}.wp-block-search__inside-wrapper{display:flex;flex:auto;flex-wrap:nowrap;max-width:100%}.wp-block-search__input{appearance:none;border:1px solid #949494;flex-grow:1;margin-left:0;margin-right:0;min-width:3rem;padding:8px;text-decoration:unset!important}:where(.wp-block-search__input){font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;text-transform:inherit}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper){border:1px solid #949494;box-sizing:border-box;padding:4px}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper) .wp-block-search__input{border:none;border-radius:0;padding:0 4px}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper) .wp-block-search__input:focus{outline:none}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper) :where(.wp-block-search__button){padding:4px 8px}</style>
<style id=wp-block-spacer-inline-css>.wp-block-spacer{clear:both}</style>
<style id=wp-block-post-title-inline-css>.wp-block-post-title{box-sizing:border-box;word-break:break-word}</style>
<style id=wp-block-list-inline-css>ol,ul{box-sizing:border-box}:root :where(.wp-block-list.has-background){padding:1.25em 2.375em}</style>
<style id=wp-block-media-text-inline-css>.wp-block-media-text{box-sizing:border-box;direction:ltr;display:grid;grid-template-rows:auto}.wp-block-media-text>.wp-block-media-text__content,.wp-block-media-text>.wp-block-media-text__media{align-self:center}.wp-block-media-text>.wp-block-media-text__media{grid-column:1;grid-row:1;margin:0}.wp-block-media-text>.wp-block-media-text__content{direction:ltr;grid-column:2;grid-row:1;padding:0 8%;word-break:break-word}.wp-block-media-text__media img{height:auto;max-width:unset;vertical-align:middle;width:100%}@media (max-width:600px){.wp-block-media-text.is-stacked-on-mobile{grid-template-columns:100%!important}.wp-block-media-text.is-stacked-on-mobile>.wp-block-media-text__media{grid-column:1;grid-row:1}.wp-block-media-text.is-stacked-on-mobile>.wp-block-media-text__content{grid-column:1;grid-row:2}}</style>
<style id=wp-block-footnotes-inline-css>.entry-content{counter-reset:footnotes}</style>
<style id=wp-block-post-content-inline-css>.wp-block-post-content{display:flow-root}</style>
<style id=wp-block-separator-inline-css>.wp-block-separator{border:none;border-top:2px solid}:root :where(.wp-block-separator.is-style-dots){height:auto;line-height:1;text-align:center}:root :where(.wp-block-separator.is-style-dots):before{color:currentColor;content:"···";font-family:serif;font-size:1.5em;letter-spacing:2em;padding-left:2em}</style>
<style>.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}</style>
<style id=wp-block-post-date-inline-css>.wp-block-post-date{box-sizing:border-box}</style>
<style id=wp-block-post-terms-inline-css>.wp-block-post-terms{box-sizing:border-box}.wp-block-post-terms .wp-block-post-terms__separator{white-space:pre-wrap}</style>
<style id=wp-block-columns-inline-css>.wp-block-columns{align-items:normal!important;box-sizing:border-box;flex-wrap:wrap!important}@media (min-width:782px){.wp-block-columns{flex-wrap:nowrap!important}}@media (max-width:781px){.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:100%!important}}@media (min-width:782px){.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:0;flex-grow:1}.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column[style*=flex-basis]{flex-grow:0}}:where(.wp-block-columns){margin-bottom:1.75em}:where(.wp-block-columns.has-background){padding:1.25em 2.375em}.wp-block-column{flex-grow:1;min-width:0;overflow-wrap:break-word;word-break:break-word}</style>
<style id=wp-block-avatar-inline-css>.wp-block-avatar{line-height:0}.wp-block-avatar,.wp-block-avatar img{box-sizing:border-box}</style>
<style id=wp-block-comment-author-name-inline-css>.wp-block-comment-author-name{box-sizing:border-box}</style>
<style id=wp-block-comment-date-inline-css>.wp-block-comment-date{box-sizing:border-box}</style>
<style id=wp-block-comment-content-inline-css>.wp-block-comment-content{box-sizing:border-box}</style>
<style id=wp-block-comment-reply-link-inline-css>.wp-block-comment-reply-link{box-sizing:border-box}</style>
<style id=wp-block-comment-template-inline-css>.wp-block-comment-template{box-sizing:border-box;list-style:none;margin-bottom:0;max-width:100%;padding:0}.wp-block-comment-template li{clear:both}.wp-block-comment-template ol{list-style:none;margin-bottom:0;max-width:100%;padding-left:2rem}</style>
<style id=wp-block-post-comments-form-inline-css>:where(.wp-block-post-comments-form) input:not([type=submit]),:where(.wp-block-post-comments-form) textarea{border:1px solid #949494;font-family:inherit;font-size:1em}:where(.wp-block-post-comments-form) input:where(:not([type=submit]):not([type=checkbox])),:where(.wp-block-post-comments-form) textarea{padding:calc(.667em + 2px)}.wp-block-post-comments-form{box-sizing:border-box}.wp-block-post-comments-form :where(input[type=submit]){box-shadow:none;cursor:pointer;display:inline-block;overflow-wrap:break-word;text-align:center}.wp-block-post-comments-form .comment-form input:not([type=submit]):not([type=checkbox]):not([type=hidden]),.wp-block-post-comments-form .comment-form textarea{box-sizing:border-box;display:block;width:100%}.wp-block-post-comments-form .comment-form-author label,.wp-block-post-comments-form .comment-form-email label,.wp-block-post-comments-form .comment-form-url label{display:block;margin-bottom:.25em}.wp-block-post-comments-form .comment-form-cookies-consent{display:flex;gap:.25em}.wp-block-post-comments-form .comment-form-cookies-consent #wp-comment-cookies-consent{margin-top:.35em}.wp-block-post-comments-form .comment-reply-title{margin-bottom:0}.wp-block-post-comments-form .comment-reply-title :where(small){font-size:var(--wp--preset--font-size--medium,smaller);margin-left:.5em}</style>
<style id=wp-block-button-inline-css>.wp-block-button__link{box-sizing:border-box;display:inline-block;text-align:center;word-break:break-word}:where(.wp-block-button__link){border-radius:9999px;box-shadow:none;padding:calc(.667em + 2px) calc(1.333em + 2px);text-decoration:none}.wp-block-button__link.no-border-radius{border-radius:0!important}:root :where(.wp-block-button .wp-block-button__link.is-style-outline),:root :where(.wp-block-button.is-style-outline>.wp-block-button__link){border:2px solid;padding:.667em 1.333em}:root :where(.wp-block-button .wp-block-button__link.is-style-outline:not(.has-text-color)),:root :where(.wp-block-button.is-style-outline>.wp-block-button__link:not(.has-text-color)){color:currentColor}:root :where(.wp-block-button .wp-block-button__link.is-style-outline:not(.has-background)),:root :where(.wp-block-button.is-style-outline>.wp-block-button__link:not(.has-background)){background-color:initial;background-image:none}</style>
<style id=wp-block-comments-inline-css>:where(.wp-block-post-comments input[type=submit]){border:none}</style>
<style>:root{--wp-admin-theme-color:#007cba;--wp-admin-theme-color--rgb:0,124,186;--wp-admin-theme-color-darker-10:#006ba1;--wp-admin-theme-color-darker-10--rgb:0,107,161;--wp-admin-theme-color-darker-20:#005a87;--wp-admin-theme-color-darker-20--rgb:0,90,135;--wp-admin-border-width-focus:2px;--wp-block-synced-color:#7a00df;--wp-block-synced-color--rgb:122,0,223;--wp-bound-block-color:var(--wp-block-synced-color)}@media (min-resolution:192dpi){:root{--wp-admin-border-width-focus:1.5px}}.wp-element-button{cursor:pointer}:root{--wp--preset--font-size--normal:16px;--wp--preset--font-size--huge:42px}.has-text-align-center{text-align:center}.has-text-align-right{text-align:right}.screen-reader-text{border:0;clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal!important}.screen-reader-text:focus{background-color:#ddd;clip:auto!important;clip-path:none;color:#444;display:block;font-size:1em;height:auto;left:5px;line-height:normal;padding:15px 23px 14px;text-decoration:none;top:5px;width:auto;z-index:100000}html :where(.has-border-color){border-style:solid}html :where([style*=border-top-color]){border-top-style:solid}html :where([style*=border-right-color]){border-right-style:solid}html :where([style*=border-bottom-color]){border-bottom-style:solid}html :where([style*=border-left-color]){border-left-style:solid}html :where([style*=border-width]){border-style:solid}html :where([style*=border-top-width]){border-top-style:solid}html :where([style*=border-right-width]){border-right-style:solid}html :where([style*=border-bottom-width]){border-bottom-style:solid}html :where([style*=border-left-width]){border-left-style:solid}html :where(img[class*=wp-image-]){height:auto;max-width:100%}:where(figure){margin:0 0 1em}html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:var(--wp-admin--admin-bar--height,0px)}@media screen and (max-width:600px){html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:0px}}</style>
<style id=global-styles-inline-css>:root{--wp--preset--aspect-ratio--square:1;--wp--preset--aspect-ratio--4-3:4/3;--wp--preset--aspect-ratio--3-4:3/4;--wp--preset--aspect-ratio--3-2:3/2;--wp--preset--aspect-ratio--2-3:2/3;--wp--preset--aspect-ratio--16-9:16/9;--wp--preset--aspect-ratio--9-16:9/16;--wp--preset--color--black:#000000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#ffffff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--color--base:#ffffff;--wp--preset--color--contrast:#000000;--wp--preset--color--primary:#9DFF20;--wp--preset--color--secondary:#345C00;--wp--preset--color--tertiary:#F6F6F6;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small:clamp(0.875rem,0.875rem + ((1vw - 0.2rem)*0.227),1rem);--wp--preset--font-size--medium:clamp(1rem,1rem + ((1vw - 0.2rem)*0.227),1.125rem);--wp--preset--font-size--large:clamp(1.75rem,1.75rem + ((1vw - 0.2rem)*0.227),1.875rem);--wp--preset--font-size--x-large:2.25rem;--wp--preset--font-size--xx-large:clamp(6.1rem,6.1rem + ((1vw - 0.2rem)*7.091),10rem);--wp--preset--font-family--dm-sans:"DM Sans",sans-serif;--wp--preset--font-family--ibm-plex-mono:"IBM Plex Mono",monospace;--wp--preset--font-family--inter:"Inter",sans-serif;--wp--preset--font-family--system-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;--wp--preset--font-family--source-serif-pro:"Source Serif Pro",serif;--wp--preset--spacing--20:0.44rem;--wp--preset--spacing--30:clamp(1.5rem,5vw,2rem);--wp--preset--spacing--40:clamp(1.8rem,1.8rem + ((1vw - 0.48rem)*2.885),3rem);--wp--preset--spacing--50:clamp(2.5rem,8vw,4.5rem);--wp--preset--spacing--60:clamp(3.75rem,10vw,7rem);--wp--preset--spacing--70:clamp(5rem,5.25rem + ((1vw - 0.48rem)*9.096),8rem);--wp--preset--spacing--80:clamp(7rem,14vw,11rem);--wp--preset--shadow--natural:6px 6px 9px rgba(0,0,0,0.2);--wp--preset--shadow--deep:12px 12px 50px rgba(0,0,0,0.4);--wp--preset--shadow--sharp:6px 6px 0px rgba(0,0,0,0.2);--wp--preset--shadow--outlined:6px 6px 0px -3px rgba(255,255,255,1),6px 6px rgba(0,0,0,1);--wp--preset--shadow--crisp:6px 6px 0px rgba(0,0,0,1)}:root{--wp--style--global--content-size:650px;--wp--style--global--wide-size:1200px}:where(body){margin:0}.has-global-padding{padding-right:var(--wp--style--root--padding-right);padding-left:var(--wp--style--root--padding-left)}.has-global-padding :where(:not(.alignfull.is-layout-flow)>.has-global-padding:not(.wp-block-block,.alignfull)){padding-right:0;padding-left:0}:where(.wp-site-blocks)>*{margin-block-start:1.5rem;margin-block-end:0}:where(.wp-site-blocks)>:first-child{margin-block-start:0}:where(.wp-site-blocks)>:last-child{margin-block-end:0}:root{--wp--style--block-gap:1.5rem}:root :where(.is-layout-flow)>:first-child{margin-block-start:0}:root :where(.is-layout-flow)>:last-child{margin-block-end:0}:root :where(.is-layout-flow)>*{margin-block-start:1.5rem;margin-block-end:0}:root :where(.is-layout-constrained)>:first-child{margin-block-start:0}:root :where(.is-layout-constrained)>:last-child{margin-block-end:0}:root :where(.is-layout-constrained)>*{margin-block-start:1.5rem;margin-block-end:0}:root :where(.is-layout-flex){gap:1.5rem}:root :where(.is-layout-grid){gap:1.5rem}.is-layout-constrained>:where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width:var(--wp--style--global--content-size);margin-left:auto!important;margin-right:auto!important}.is-layout-constrained>.alignwide{max-width:var(--wp--style--global--wide-size)}body .is-layout-flex{display:flex}.is-layout-flex{flex-wrap:wrap;align-items:center}.is-layout-flex>:is(*,div){margin:0}body{background-color:var(--wp--preset--color--base);color:var(--wp--preset--color--contrast);font-family:var(--wp--preset--font-family--system-font);font-size:var(--wp--preset--font-size--medium);line-height:1.6;--wp--style--root--padding-top:var(--wp--preset--spacing--40);--wp--style--root--padding-right:var(--wp--preset--spacing--30);--wp--style--root--padding-bottom:var(--wp--preset--spacing--40);--wp--style--root--padding-left:var(--wp--preset--spacing--30)}a:where(:not(.wp-element-button)){color:var(--wp--preset--color--contrast);text-decoration:underline}:root :where(a:where(:not(.wp-element-button)):hover){text-decoration:none}:root :where(a:where(:not(.wp-element-button)):focus){text-decoration:underline dashed}:root :where(a:where(:not(.wp-element-button)):active){color:var(--wp--preset--color--secondary);text-decoration:none}h3,h4{line-height:1.4}h1{line-height:1.2}h2{line-height:1.2}:root :where(.wp-element-button,.wp-block-button__link){background-color:var(--wp--preset--color--primary);border-radius:0;border-width:0;color:var(--wp--preset--color--contrast);font-family:inherit;font-size:inherit;line-height:inherit;padding:calc(0.667em + 2px) calc(1.333em + 2px);text-decoration:none}:root :where(.wp-element-button:visited,.wp-block-button__link:visited){color:var(--wp--preset--color--contrast)}:root :where(.wp-element-button:hover,.wp-block-button__link:hover){background-color:var(--wp--preset--color--contrast);color:var(--wp--preset--color--base)}:root :where(.wp-element-button:focus,.wp-block-button__link:focus){background-color:var(--wp--preset--color--contrast);color:var(--wp--preset--color--base)}:root :where(.wp-element-button:active,.wp-block-button__link:active){background-color:var(--wp--preset--color--secondary);color:var(--wp--preset--color--base)}.has-small-font-size{font-size:var(--wp--preset--font-size--small)!important}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium)!important}.has-large-font-size{font-size:var(--wp--preset--font-size--large)!important}:root :where(.wp-block-navigation){font-size:var(--wp--preset--font-size--small)}:root :where(.wp-block-navigation a:where(:not(.wp-element-button))){text-decoration:none}:root :where(.wp-block-navigation a:where(:not(.wp-element-button)):hover){text-decoration:underline}:root :where(.wp-block-navigation a:where(:not(.wp-element-button)):focus){text-decoration:underline dashed}:root :where(.wp-block-navigation a:where(:not(.wp-element-button)):active){text-decoration:none}:root :where(.wp-block-post-content a:where(:not(.wp-element-button))){color:var(--wp--preset--color--secondary)}:root :where(.wp-block-post-date){font-size:var(--wp--preset--font-size--small);font-weight:400}:root :where(.wp-block-post-date a:where(:not(.wp-element-button))){text-decoration:none}:root :where(.wp-block-post-date a:where(:not(.wp-element-button)):hover){text-decoration:underline}:root :where(.wp-block-post-terms){font-size:var(--wp--preset--font-size--small)}:root :where(.wp-block-post-title){font-weight:400;margin-top:1.25rem;margin-bottom:1.25rem}:root :where(.wp-block-post-title a:where(:not(.wp-element-button))){text-decoration:none}:root :where(.wp-block-post-title a:where(:not(.wp-element-button)):hover){text-decoration:underline}:root :where(.wp-block-post-title a:where(:not(.wp-element-button)):focus){text-decoration:underline dashed}:root :where(.wp-block-post-title a:where(:not(.wp-element-button)):active){color:var(--wp--preset--color--secondary);text-decoration:none}:root :where(.wp-block-comments-title){font-size:var(--wp--preset--font-size--large);margin-bottom:var(--wp--preset--spacing--40)}:root :where(.wp-block-comment-author-name a:where(:not(.wp-element-button))){text-decoration:none}:root :where(.wp-block-comment-author-name a:where(:not(.wp-element-button)):hover){text-decoration:underline}:root :where(.wp-block-comment-author-name a:where(:not(.wp-element-button)):focus){text-decoration:underline dashed}:root :where(.wp-block-comment-author-name a:where(:not(.wp-element-button)):active){color:var(--wp--preset--color--secondary);text-decoration:none}:root :where(.wp-block-comment-date){font-size:var(--wp--preset--font-size--small)}:root :where(.wp-block-comment-date a:where(:not(.wp-element-button))){text-decoration:none}:root :where(.wp-block-comment-date a:where(:not(.wp-element-button)):hover){text-decoration:underline}:root :where(.wp-block-comment-date a:where(:not(.wp-element-button)):focus){text-decoration:underline dashed}:root :where(.wp-block-comment-date a:where(:not(.wp-element-button)):active){color:var(--wp--preset--color--secondary);text-decoration:none}:root :where(.wp-block-comment-edit-link){font-size:var(--wp--preset--font-size--small)}:root :where(.wp-block-comment-reply-link){font-size:var(--wp--preset--font-size--small)}:root :where(.wp-block-comments-pagination){margin-top:var(--wp--preset--spacing--40)}:root :where(.wp-block-comments-pagination a:where(:not(.wp-element-button))){text-decoration:none}:root :where(.wp-block-separator){}:root :where(.wp-block-separator:not(.is-style-wide):not(.is-style-dots):not(.alignwide):not(.alignfull)){width:100px}</style>
<style id=core-block-supports-inline-css>.wp-container-core-group-is-layout-1{flex-wrap:nowrap}.wp-container-core-group-is-layout-2{flex-direction:column;align-items:flex-end}.wp-container-core-group-is-layout-3{flex-wrap:nowrap;justify-content:space-between}.wp-container-core-group-is-layout-5{flex-wrap:nowrap;justify-content:flex-start}.wp-container-core-group-is-layout-8>:where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width:480px;margin-left:auto!important;margin-right:auto!important}.wp-container-core-group-is-layout-10{gap:0.5ch}.wp-container-core-column-is-layout-1>*{margin-block-start:0;margin-block-end:0}.wp-container-core-columns-is-layout-1{flex-wrap:nowrap;gap:var(--wp--preset--spacing--30)}.wp-container-core-columns-is-layout-2{flex-wrap:nowrap}.wp-container-core-columns-is-layout-3{flex-wrap:nowrap}.wp-container-core-columns-is-layout-4{flex-wrap:nowrap}.wp-container-core-columns-is-layout-5{flex-wrap:nowrap}.wp-container-core-columns-is-layout-6{flex-wrap:nowrap}.wp-container-core-columns-is-layout-7{flex-wrap:nowrap}.wp-container-core-group-is-layout-20{justify-content:space-between}</style>
<style id=wp-block-template-skip-link-inline-css>.skip-link.screen-reader-text{border:0;clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute!important;width:1px;word-wrap:normal!important}.skip-link.screen-reader-text:focus{background-color:#eee;clip:auto!important;clip-path:none;color:#444;display:block;font-size:1em;height:auto;left:5px;line-height:normal;padding:15px 23px 14px;text-decoration:none;top:5px;width:auto;z-index:100000}</style>
<style>body{margin:0;--wp--style--global--content-size:960px;--wp--style--global--wide-size:960px;--wp--preset--color--primary:#00a82d;--wp--preset--color--secondary:#00c234;--wp--preset--color--tertiary:#f6f6f6;--wp--preset--color--contrast:#000000;--wp--preset--color--highlight:#c64f00}main{margin-top:0!important}h1{font-size:2.50rem;font-weight:400;margin-top:48px}h2{font-size:2.00rem;font-weight:400;margin-top:36px}h3{font-size:1.625rem;font-weight:400;margin-top:28px}h4{font-weight:400;margin-top:22px}.wp-site-blocks{padding-top:1em;padding-bottom:1em}header div#cx-mainheader{margin-top:-12px}header div#cx-mainheader p{font-size:14px}header form.wp-block-search>div{padding:1px}header form.wp-block-search button{padding:0}header form.wp-block-search svg.search-icon{height:16px;min-height:16px;min-width:16px}header div#cx-mainheader div{gap:0;margin-bottom:3px}.wp-block-navigation li.colfax-sites-menu{border:none!important;padding-left:0;font-size:90%;color:var(--wp--preset--color--primary)}div#cx-mainmenu>div{padding-bottom:0em!important;border-radius:3px;border:1px solid #eeeeee;border-bottom:2px solid #cccccc;background:#fefefe;background:-webkit-linear-gradient(top,#fefefe 0%,#ededed 100%);background:-moz-linear-gradient(top,#fefefe 0%,#ededed 100%);background:-o-linear-gradient(top,#fefefe 0%,#ededed 100%);background:-ms-linear-gradient(top,#fefefe 0%,#ededed 100%)}.wp-block-navigation ul,.wp-block-navigation ul li{line-height:35px;gap:0px}.wp-block-navigation .wp-block-navigation-item{margin-left:-1px;border-right:1px dotted #cccccc!important;border-left:1px dotted #cccccc!important}.wp-block-navigation .wp-block-navigation-item a{padding-left:1em;padding-right:1em}button.wp-block-navigation__submenu-icon{padding-right:1em!important}.wp-block-navigation:hover .wp-block-navigation-item:hover{background-color:#00c234;-webkit-transition:all 1s ease;-moz-transition:all 1s ease;-ms-transition:all 1s ease;-o-transition:all 1s ease;transition:all 1s ease;text-decoration:none}.wp-block-navigation a:where(:not(.wp-element-button)):hover{text-decoration:none!important}.wp-element-button:visited,.wp-block-button__link:visited,.wp-element-button,.wp-block-button__link{color:var(--wp--preset--color--base);text-transform:uppercase;font-size:20px;font-style:normal}.wp-element-button:hover,.wp-block-button__link:hover{background-color:var(--wp--preset--color--secondary)}.wp-element-button,.wp-block-button__link{color:var(--wp--preset--color--base);background-color:var(--wp--preset--color--primary);-webkit-transition:all .25s ease;-moz-transition:all .25s ease;-ms-transition:all .25s ease;-o-transition:all .25s ease;transition:all .25s ease}.wp-block-post-content a:where(:not(.wp-element-button)){color:var(--wp--preset--color--primary)}.wp-block-post-content a:hover:where(:not(.wp-element-button)){color:var(--wp--preset--color--highlight);text-decoration:underline}</style>
<style>div.sharedaddy{clear:both}div.sharedaddy h3.sd-title{margin:0 0 1em 0;display:inline-block;line-height:1.2;font-size:9pt;font-weight:bold}.sd-sharing{margin-bottom:1em}.sd-content ul{padding:0!important;margin:0!important;list-style:none!important}.sd-content ul li{display:inline-block}.sd-social-icon-text .sd-content ul li a.sd-button{text-decoration:none!important;display:inline-block;font-size:13px;font-family:"Open Sans",sans-serif;font-weight:500;border-radius:4px;color:#2C3338!important;background:#fff;box-shadow:0 1px 2px rgba(0,0,0,0.12),0 0 0 1px rgba(0,0,0,0.12);text-shadow:none;line-height:23px;padding:4px 11px 3px 9px}.sd-social-icon-text .sd-content ul li a.sd-button>span{line-height:23px;margin-left:6px}.sd-social-icon .sd-content ul li a.sd-button:hover,.sd-social-icon .sd-content ul li a.sd-button:active,.sd-social-text .sd-content ul li a.sd-button:hover,.sd-social-text .sd-content ul li a.sd-button:active,.sd-social-icon-text .sd-content ul li a.sd-button:hover,.sd-social-icon-text .sd-content ul li a.sd-button:active,.sd-social-official .sd-content>ul>li>a.sd-button:hover,.sd-social-official .sd-content>ul>li>a.sd-button:active,.sd-social-official .sd-content>ul>li .digg_button>a:hover,.sd-social-official .sd-content>ul>li .digg_button>a:active{box-shadow:0 1px 2px rgba(0,0,0,0.22),0 0 0 1px rgba(0,0,0,0.22)}.sd-social-icon .sd-content ul li a.sd-button:active,.sd-social-text .sd-content ul li a.sd-button:active,.sd-social-icon-text .sd-content ul li a.sd-button:active,.sd-social-official .sd-content>ul>li>a.sd-button:active,.sd-social-official .sd-content>ul>li .digg_button>a:active{box-shadow:inset 0 1px 0 rgba(0,0,0,.16)}.sd-content ul li a.sd-button:before{display:inline-block;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font:normal 18px/1"social-logos";vertical-align:top;text-align:center}.sd-social-icon-text ul li a.sd-button:before{position:relative;top:2px}@media screen and (-webkit-min-device-pixel-ratio:0){.sd-content ul li a.sd-button:before{position:relative;top:2px}}@media screen and (-webkit-min-device-pixel-ratio:0){}.sd-content ul li{margin:0 8px 12px 0;padding:0}@media screen and (-webkit-min-device-pixel-ratio:0){}@-moz-document url-prefix(){.sd-social-icon .sd-content ul li a.share-more{top:2px}}.sd-social-icon .sd-content ul li.share-linkedin a:before,.sd-social-text .sd-content ul li.share-linkedin a:before,.sd-content ul li.share-linkedin div.option.option-smart-off a:before,.sd-social-icon-text .sd-content li.share-linkedin a:before{content:""}.sd-social-icon .sd-content ul li.share-twitter a:before,.sd-social-text .sd-content ul li.share-twitter a:before,.sd-content ul li.share-twitter div.option.option-smart-off a:before,.sd-social-icon-text .sd-content li.share-twitter a:before{content:""}.sd-social-icon .sd-content ul li.share-reddit a:before,.sd-social-text .sd-content ul li.share-reddit a:before,.sd-content ul li.share-reddit div.option.option-smart-off a:before,.sd-social-icon-text .sd-content li.share-reddit a:before,.sd-social-official .sd-content li.share-reddit a:before{content:""}.sd-social-icon .sd-content ul li.share-facebook a:before,.sd-social-text .sd-content ul li.share-facebook a:before,.sd-content ul li.share-facebook div.option.option-smart-off a:before,.sd-social-icon-text .sd-content li.share-facebook a:before{content:""}</style>
<style>@font-face{font-family:social-logos;src:url(data:application/octet-stream;base64,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)format("woff2");display:inline-block;vertical-align:middle;line-height:1;font-weight:400;font-style:normal;speak:none;text-decoration:inherit;text-transform:none;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}</style>
<link rel=https://api.w.org/ href=https://research.colfax-intl.com/wp-json/><link rel=alternate title=JSON type=application/json href=https://research.colfax-intl.com/wp-json/wp/v2/posts/11566><link rel=EditURI type=application/rsd+xml title=RSD href=https://research.colfax-intl.com/xmlrpc.php?rsd>
<meta name=generator content="WordPress 6.7">
<link rel=canonical href=https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/>
<link rel=shortlink href=https://wp.me/pfwen0-30y>
<link rel=alternate title="oEmbed (JSON)" type=application/json+oembed href="https://research.colfax-intl.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fresearch.colfax-intl.com%2Fcutlass-tutorial-wgmma-hopper%2F">
<link rel=alternate title="oEmbed (XML)" type=text/xml+oembed href="https://research.colfax-intl.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fresearch.colfax-intl.com%2Fcutlass-tutorial-wgmma-hopper%2F&amp;format=xml">
<meta property=og:type content=article>
<meta property=og:title content="CUTLASS Tutorial: Fast Matrix-Multiplication with WGMMA on NVIDIA® Hopper™ GPUs">
<meta property=og:url content=https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/>
<meta property=og:description content="No series of CUDA® tutorials is complete without a section on GEMM (GEneral Matrix Multiplication). Arguably the most important routine on modern GPUs, GEMM constitutes the majority of compute done…">
<meta property=article:published_time content=2024-08-06T16:33:04+00:00>
<meta property=article:modified_time content=2024-11-19T17:21:55+00:00>
<meta property=og:site_name content="Colfax Research">
<meta property=og:image content="https://i0.wp.com/research.colfax-intl.com/wp-content/uploads/2024/07/wgmma-64N16-D-1.png?fit=1200%2C758&amp;ssl=1">
<meta property=og:image:width content=1200>
<meta property=og:image:height content=758>
<meta property=og:image:alt content>
<meta property=og:locale content=en_US>
<meta name=twitter:site content=@colfaxintl>
<meta name=twitter:text:title content="CUTLASS Tutorial: Fast Matrix-Multiplication with WGMMA on NVIDIA® Hopper™ GPUs">
<meta name=twitter:image content="https://i0.wp.com/research.colfax-intl.com/wp-content/uploads/2024/07/wgmma-64N16-D-1.png?fit=1200%2C758&amp;ssl=1&amp;w=640">
<meta name=twitter:card content=summary_large_image>
<link rel=icon href="data:image/webp;base64,UklGRlAAAABXRUJQVlA4TEQAAAAvv8AvEA8wqDEt8x84FLWN5ERaAAtpqR+kA9DLu98jov8K0jZgWg87FpiQIXclD7rctZ+GieXwBcLnrHcHgBvD9/xrAA==" sizes=192x192>
<meta name=msapplication-TileImage content="https://i0.wp.com/research.colfax-intl.com/wp-content/uploads/2024/02/colfax-favicon.png?fit=270%2C270&amp;ssl=1">
<style>.syntaxhighlighter div,.syntaxhighlighter code,.syntaxhighlighter table,.syntaxhighlighter table td,.syntaxhighlighter table tr,.syntaxhighlighter table tbody{-moz-border-radius:0 0 0 0!important;-webkit-border-radius:0 0 0 0!important;background:none!important;border:0!important;bottom:auto!important;float:none!important;height:auto!important;left:auto!important;line-height:1.1em!important;margin:0!important;outline:0!important;overflow:visible!important;padding:0!important;position:static!important;right:auto!important;text-align:left!important;top:auto!important;vertical-align:baseline!important;width:auto!important;box-sizing:content-box!important;font-family:Monaco,"Consolas","Bitstream Vera Sans Mono","Courier New",Courier,monospace!important;font-weight:normal!important;font-style:normal!important;font-size:1em!important;direction:ltr!important;-webkit-box-shadow:none!important;-moz-box-shadow:none!important;-ms-box-shadow:none!important;-o-box-shadow:none!important;box-shadow:none!important}.syntaxhighlighter{width:100%!important;margin:1em 0 1em 0!important;position:relative!important;overflow:auto!important;overflow-y:hidden!important;font-size:1em!important;padding:0.5em 1em!important}.syntaxhighlighter code{display:inline!important}.syntaxhighlighter .bold{font-weight:bold!important}.syntaxhighlighter .line{white-space:pre!important}.syntaxhighlighter table{table-layout:auto!important;width:100%!important}.syntaxhighlighter table td.code{width:100%!important}.syntaxhighlighter table td.code .container{position:relative!important}.syntaxhighlighter table td.code .container:after,.syntaxhighlighter table td.code .container:before{display:block!important;content:""}.syntaxhighlighter table td.gutter .line{text-align:right!important;padding:0 0.5em 0 0!important;margin-right:1em!important}.syntaxhighlighter table td.code .line{padding:0!important}.syntaxhighlighter.nogutter td.code .line{padding-left:0em!important}</style><style>.syntaxhighlighter{background-color:white!important}.syntaxhighlighter .line.alt1{background-color:white!important}.syntaxhighlighter .line.alt2{background-color:white!important}.syntaxhighlighter .line.highlighted.alt1,.syntaxhighlighter .line.highlighted.alt2{background-color:#e0e0e0!important}.syntaxhighlighter .gutter{color:#afafaf!important}.syntaxhighlighter .gutter .line{border-right:3px solid #6ce26c!important}.syntaxhighlighter .gutter .line.highlighted{background-color:#6ce26c!important;color:white!important}.syntaxhighlighter .plain{color:black!important}.syntaxhighlighter .comments{color:#008200!important}.syntaxhighlighter .string{color:blue!important}.syntaxhighlighter .keyword{color:#006699!important}.syntaxhighlighter .preprocessor{color:gray!important}.syntaxhighlighter .color1{color:gray!important}.syntaxhighlighter .keyword{font-weight:bold!important}</style><style id=ctre_styles>@media (prefers-color-scheme:dark){}</style><meta name=referrer content=no-referrer><style>.sf-hidden{display:none!important}</style><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
<body class="post-template-default single single-post postid-11566 single-format-standard wp-custom-logo wp-embed-responsive">
<a class="skip-link screen-reader-text" href=#wp--skip-link--target>Skip to content</a><div class=wp-site-blocks><header class=wp-block-template-part>
<div id=cx-mainheader class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-3 wp-block-group-is-layout-flex">
<div class="wp-block-group is-nowrap is-layout-flex wp-container-core-group-is-layout-1 wp-block-group-is-layout-flex">
<figure class="wp-block-image size-large is-resized"><img fetchpriority=high decoding=async width=1024 height=357 src="data:image/webp;base64,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" alt class=wp-image-9229 style=width:162px srcset sizes></figure>
<nav class="is-responsive wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label="Colfax Sites" data-wp-interactive=core/navigation data-wp-context='{"overlayOpenedBy":{"click":false,"hover":false,"focus":false},"type":"overlay","roleAttribute":"","ariaLabel":"Menu"}'><button aria-haspopup=dialog aria-label="Open menu" class="wp-block-navigation__responsive-container-open sf-hidden" data-wp-on-async--click=actions.openMenuOnClick data-wp-on--keydown=actions.handleMenuKeydown><svg width=24 height=24 xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" aria-hidden=true focusable=false><rect x=4 y=7.5 width=16 height=1.5></rect><rect x=4 y=15 width=16 height=1.5></rect></svg></button>
 <div class=wp-block-navigation__responsive-container id=modal-1 data-wp-class--has-modal-open=state.isMenuOpen data-wp-class--is-menu-open=state.isMenuOpen data-wp-watch=callbacks.initMenu data-wp-on--keydown=actions.handleMenuKeydown data-wp-on-async--focusout=actions.handleMenuFocusout tabindex=-1>
 <div class=wp-block-navigation__responsive-close tabindex=-1>
 <div class=wp-block-navigation__responsive-dialog data-wp-bind--aria-modal=state.ariaModal data-wp-bind--aria-label=state.ariaLabel data-wp-bind--role=state.roleAttribute>
 <button aria-label="Close menu" class="wp-block-navigation__responsive-container-close sf-hidden" data-wp-on-async--click=actions.closeMenuOnClick><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true focusable=false><path d="m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"></path></svg></button>
 <div class=wp-block-navigation__responsive-container-content data-wp-watch=callbacks.focusFirstElement id=modal-1-content>
 <ul class="wp-block-navigation__container is-responsive wp-block-navigation"><li data-wp-context='{ "submenuOpenedBy": { "click": false, "hover": false, "focus": false }, "type": "submenu" }' data-wp-interactive=core/navigation data-wp-on--focusout=actions.handleMenuFocusout data-wp-on--keydown=actions.handleMenuKeydown data-wp-on-async--mouseenter=actions.openMenuOnHover data-wp-on-async--mouseleave=actions.closeMenuOnHover data-wp-watch=callbacks.initMenu tabindex=-1 class="wp-block-navigation-item has-child open-on-hover-click colfax-sites-menu wp-block-navigation-submenu"><a class=wp-block-navigation-item__content>▼</a><button data-wp-bind--aria-expanded=state.isMenuOpen data-wp-on-async--click=actions.toggleMenuOnClick aria-label="▼ submenu" class="wp-block-navigation__submenu-icon wp-block-navigation-submenu__toggle sf-hidden" aria-expanded=false><svg xmlns=http://www.w3.org/2000/svg width=12 height=12 viewBox="0 0 12 12" fill=none aria-hidden=true focusable=false><path d="M1.50002 4L6.00002 8L10.5 4" stroke-width=1.5></path></svg></button><ul data-wp-on-async--focus=actions.openMenuOnFocus class="wp-block-navigation__submenu-container colfax-sites-menu wp-block-navigation-submenu"><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://www.colfax-intl.com/><span class=wp-block-navigation-item__label>Systems</span></a><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://colfaxdirect.com/><span class=wp-block-navigation-item__label>Components</span></a><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://research.colfax-intl.com/><span class=wp-block-navigation-item__label>Research</span></a><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://experience.colfax-intl.com/><span class=wp-block-navigation-item__label>Experience Center</span></a></ul></ul>
 </div>
 </div>
 </div>
 </div></nav></div>
<div class="wp-block-group is-vertical is-content-justification-right is-layout-flex wp-container-core-group-is-layout-2 wp-block-group-is-layout-flex">
<p class=has-text-align-right>2805 Bowers Ave, Santa Clara, CA 95051 | 408-730-2275<br><a href=mailto:research@colfax-intl.com>research@colfax-intl.com</a></p>
<form role=search action=https://research.colfax-intl.com/ class="wp-block-search__button-inside wp-block-search__icon-button wp-block-search"><label class="wp-block-search__label screen-reader-text" for=wp-block-search__input-2>Search</label><div class=wp-block-search__inside-wrapper style=width:100%><input class=wp-block-search__input id=wp-block-search__input-2 placeholder value type=search name=s required><button aria-label=Search class="wp-block-search__button has-icon wp-element-button" type=submit><svg class=search-icon viewBox="0 0 24 24" width=24 height=24>
 <path d="M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"></path>
 </svg></button></div></form></div>
</div>
</div>
<div id=cx-mainmenu class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group alignwide is-content-justification-left is-nowrap is-layout-flex wp-container-core-group-is-layout-5 wp-block-group-is-layout-flex" style=padding-bottom:var(--wp--preset--spacing--40)><nav class="is-responsive wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label=Navigation data-wp-interactive=core/navigation data-wp-context='{"overlayOpenedBy":{"click":false,"hover":false,"focus":false},"type":"overlay","roleAttribute":"","ariaLabel":"Menu"}'><button aria-haspopup=dialog aria-label="Open menu" class="wp-block-navigation__responsive-container-open sf-hidden" data-wp-on-async--click=actions.openMenuOnClick data-wp-on--keydown=actions.handleMenuKeydown><svg width=24 height=24 xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" aria-hidden=true focusable=false><rect x=4 y=7.5 width=16 height=1.5></rect><rect x=4 y=15 width=16 height=1.5></rect></svg></button>
 <div class=wp-block-navigation__responsive-container id=modal-3 data-wp-class--has-modal-open=state.isMenuOpen data-wp-class--is-menu-open=state.isMenuOpen data-wp-watch=callbacks.initMenu data-wp-on--keydown=actions.handleMenuKeydown data-wp-on-async--focusout=actions.handleMenuFocusout tabindex=-1>
 <div class=wp-block-navigation__responsive-close tabindex=-1>
 <div class=wp-block-navigation__responsive-dialog data-wp-bind--aria-modal=state.ariaModal data-wp-bind--aria-label=state.ariaLabel data-wp-bind--role=state.roleAttribute>
 <button aria-label="Close menu" class="wp-block-navigation__responsive-container-close sf-hidden" data-wp-on-async--click=actions.closeMenuOnClick><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true focusable=false><path d="m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"></path></svg></button>
 <div class=wp-block-navigation__responsive-container-content data-wp-watch=callbacks.focusFirstElement id=modal-3-content>
 <ul class="wp-block-navigation__container is-responsive wp-block-navigation"><li class="wp-block-navigation-item wp-block-home-link"><a class="wp-block-home-link__content wp-block-navigation-item__content" href=https://research.colfax-intl.com/ rel=home>Home</a><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://research.colfax-intl.com/research/><span class=wp-block-navigation-item__label>Research</span></a><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://research.colfax-intl.com/blog/><span class=wp-block-navigation-item__label>Articles</span></a><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://research.colfax-intl.com/videos/><span class=wp-block-navigation-item__label>Videos</span></a><li data-wp-context='{ "submenuOpenedBy": { "click": false, "hover": false, "focus": false }, "type": "submenu" }' data-wp-interactive=core/navigation data-wp-on--focusout=actions.handleMenuFocusout data-wp-on--keydown=actions.handleMenuKeydown data-wp-on-async--mouseenter=actions.openMenuOnHover data-wp-on-async--mouseleave=actions.closeMenuOnHover data-wp-watch=callbacks.initMenu tabindex=-1 class="wp-block-navigation-item has-child open-on-hover-click wp-block-navigation-submenu"><a class=wp-block-navigation-item__content href=#>About</a><button data-wp-bind--aria-expanded=state.isMenuOpen data-wp-on-async--click=actions.toggleMenuOnClick aria-label="About submenu" class="wp-block-navigation__submenu-icon wp-block-navigation-submenu__toggle" aria-expanded=false><svg xmlns=http://www.w3.org/2000/svg width=12 height=12 viewBox="0 0 12 12" fill=none aria-hidden=true focusable=false><path d="M1.50002 4L6.00002 8L10.5 4" stroke-width=1.5></path></svg></button><ul data-wp-on-async--focus=actions.openMenuOnFocus class="wp-block-navigation__submenu-container wp-block-navigation-submenu"><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://research.colfax-intl.com/mission-statement/><span class=wp-block-navigation-item__label>Mission</span></a></ul><li class="wp-block-navigation-item wp-block-navigation-link"><a class=wp-block-navigation-item__content href=https://colfaxresearch.com/><span class=wp-block-navigation-item__label> Archived Content</span></a></ul>
 </div>
 </div>
 </div>
 </div></nav></div>
</div>
<div style=height:40px aria-hidden=true class=wp-block-spacer></div>
</header>
<main class="wp-block-group is-layout-flow wp-block-group-is-layout-flow" style=margin-top:var(--wp--preset--spacing--50) id=wp--skip-link--target>
<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained"><h1 style=margin-bottom:var(--wp--preset--spacing--40) class=wp-block-post-title>CUTLASS Tutorial: Fast Matrix-Multiplication with WGMMA on NVIDIA® Hopper™ GPUs</h1></div>
<div class="entry-content wp-block-post-content has-global-padding is-layout-constrained wp-block-post-content-is-layout-constrained">
<p>No series of CUDA® tutorials is complete without a section on GEMM (GEneral Matrix Multiplication). Arguably the most important routine on modern GPUs, GEMM constitutes the majority of compute done in neural networks, large language models, and many graphics applications. Despite its ubiquity, GEMM is notoriously hard to implement efficiently.</p>
<p>This 3-part tutorial series aims to equip readers with a thorough understanding of how to write efficient GEMM kernels on NVIDIA Hopper GPUs using the CUTLASS library.</p>
<ul class=wp-block-list>
<li>[Part 1, this one] discusses the warpgroup matrix-multiply-accumulate (WGMMA) instructions. These are the primitive instructions that target the Tensor Core of NVIDIA GPUs based on the Hopper architecture.</li>
<li>[Part 2] will discuss the overall design of an <a href=https://github.com/NVIDIA/cutlass/blob/main/media/docs/efficient_gemm.md data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/main/media/docs/efficient_gemm.md>efficient GEMM kernel</a>, including advanced techniques used in CUTLASS kernels such as warp-specialization and ping-pong scheduling.</li>
<li>[Part 3] will discuss persistent kernels and <a href=https://arxiv.org/abs/2301.03598>Stream-K</a>, a load-balancing strategy for GEMM that achieves state-of-the-art efficiency across a vast number of problem geometries.</li>
</ul>
<p><strong>The big picture.</strong> The 3 parts in our series loosely follow the entire development process of a GEMM kernel, but “inward-out”. First, we have the tilewise GEMM primitive that calls the Tensor Cores to ultimately do the computation. Second, we have the GEMM kernel design as seen “per CTA” — consisting of a <em>prologue</em>, <em>mainloop</em>, and <em>epilogue</em> — where the main challenge is to not bottleneck the fast Tensor Cores on memory loads. Lastly, we have the scheduling of CTAs at the outermost grid level, where load-balancing considerations rise to the forefront.</p>
<p>We hope that after going through this series, readers will become experts on the GEMM algorithm, and can utilize some of the beautiful ideas that go into this algorithm to design and implement other kernels in their own work.</p>
<h3 class=wp-block-heading>Asynchronous Warpgroup MMA (WGMMA)</h3>
<p>Hopper introduces the asynchronous warpgroup-level matrix multiply and accumulate operation (WGMMA). A <em>warpgroup</em> consists of four contiguous warps, i.e., 128 contiguous threads, where the warp-rank of the first warp is a multiple of four. The <code>wgmma.mma_async</code> instruction is executed collectively by all 128 threads in a warpgroup. This operation typically follows one of these forms, where matrix <code>C</code> serves as the accumulator:</p>
<ul class=wp-block-list>
<li><code>C&nbsp;=&nbsp;A&nbsp;*&nbsp;B&nbsp;+&nbsp;C</code></li>
<li><code>C&nbsp;=&nbsp;A&nbsp;*&nbsp;B</code>, where the input from accumulator <code>C</code> is disabled.</li>
</ul>
<p>A notable requirement of WGMMA is that operand <code>B</code> must always be stored in shared memory (SMEM). In contrast, operand <code>A</code> can be located in either SMEM or register memory (RMEM), and the accumulator <code>C</code> is always held in RMEM.</p>
<p>This blog post is organized as follows. First, we discuss the essentials for invoking the <code>wgmma.mma_async</code> instruction in CUTLASS. This involves constructing the relevant <code>TiledMMA</code> object, as well as creating and partitioning the SMEM tensors in order to be compatible with WGMMA. Second, we discuss the synchronization mechanisms necessary to ensure the correctness of WGMMA. Finally, we discuss in greater detail the layouts used in WGMMA, including the concept of <em>core matrices</em> and <em>matrix descriptors</em> for operands sourced from SMEM.</p>
<p>Throughout, for the sake of concision we will abbreviate <code>wgmma.mma_async</code> as <code>wgmma</code>. Our main code reference will be the CUTLASS <a href=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/examples/cute/tutorial/wgmma_sm90.cu data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/examples/cute/tutorial/wgmma_sm90.cu>wgmma tutorial</a> contributed by Pradeep Ramani, which was added in the 3.5.1 release.</p>
<h3 class=wp-block-heading>WGMMA inside a CUTLASS kernel</h3>
<p>Our main goal in this tutorial is to explain the <code>wgmma</code> primitives for calling the Hopper Tensor Cores to do tile-based GEMM, and how to invoke it as part of a <code>cute::gemm</code> call. To set the stage, consider a standard GEMM kernel that takes input matrices <code>A</code> and <code>B</code> with dimensions <code>MxNxK</code> and computes <code>C=A*B</code>. To parallelize the computation, the kernel fixes static tile sizes <code>bM</code>, <code>bN</code>, and <code>bK</code> and launches a grid of <code>⌈M/bM⌉x⌈N/bN⌉</code> many CTAs, with each CTA computing a <code>bMxbN</code> tile <code>rC</code> of the output matrix. This will be held in the CTAs’ RMEM before being written back to the global <code>C</code> matrix.</p>
<p>Per CTA, we then have the kernel’s <em>mainloop</em>. Over <code>⌈K/bK⌉</code> many iterations, we loop over the inner dimension and successively load in <code>bMxbK</code> and <code>bNxbK</code> tiles of <code>A</code> and <code>B</code> from global into shared memory as <code>sA</code> and <code>sB</code>; note that in CUTLASS, we fix the shape of <code>sB</code> to be the transpose of what it is mathematically. (In fact, mirroring common practice, we load tiles of <code>A</code> and <code>B</code> into circular SMEM buffers, where the number of stages is given by a compile-time integer such as 2 or 3. The last mode of the shape tuples for <code>sA</code> and <code>sB</code> is then given by this stage count.) The <code>cute::gemm</code> call then computes the product of (stagewise slices of) <code>sA</code> and <code>sB</code> and successively accumulates the value into <code>rC</code>. After the mainloop completes, the epilogue then writes out <code>rC</code> to global memory.</p>
<p>Now, we wish to explain the following <code>cute::gemm</code> call and the arguments that go into it, as they appear in the following code snippet that we selectively extract from the <a href=https://github.com/NVIDIA/cutlass/blob/main/examples/cute/tutorial/wgmma_sm90.cu#L73 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/main/examples/cute/tutorial/wgmma_sm90.cu#L73>wgmma tutorial</a> (hiding the parts of the program not relevant for us, like the pipelined TMA loads):</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_125819 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1 highlighted">6</div><div class="line number7 index6 alt2 highlighted">7</div><div class="line number8 index7 alt1 highlighted">8</div><div class="line number9 index8 alt2 highlighted">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1 highlighted">12</div><div class="line number13 index12 alt2 highlighted">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1 highlighted">16</div><div class="line number17 index16 alt2 highlighted">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2 highlighted">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2 highlighted">25</div><div class="line number26 index25 alt1 highlighted">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1 highlighted">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp keyword bold">template</code> <code class="cpp plain">&lt;</code><code class="cpp keyword bold">class</code> <code class="cpp plain">TiledMMA, ... &gt;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">__global__ device_gemm(TiledMMA tiled_mma, ...) {</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// PROLOGUE</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// ...</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// Define A/B partitioning and C accumulators</code></div><div class="line number6 index5 alt1 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">ThrMMA thr_mma = tiled_mma.get_thread_slice(threadIdx.x);</code></div><div class="line number7 index6 alt2 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">Tensor tCsA = thr_mma.partition_A(sA);&nbsp; </code><code class="cpp comments">// (MMA,MMA_M,MMA_K,PIPE)</code></div><div class="line number8 index7 alt1 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">Tensor tCsB = thr_mma.partition_B(sB);&nbsp; </code><code class="cpp comments">// (MMA,MMA_N,MMA_K,PIPE)</code></div><div class="line number9 index8 alt2 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">Tensor tCgC = thr_mma.partition_C(gC);&nbsp; </code><code class="cpp comments">// (MMA,MMA_M,MMA_N)</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// Allocate accumulators and clear them</code></div><div class="line number12 index11 alt1 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">Tensor tCrC = thr_mma.make_fragment_C(tCgC);&nbsp; </code><code class="cpp comments">// (MMA,MMA_M,MMA_N)</code></div><div class="line number13 index12 alt2 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">clear(tCrC);</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// Allocate "fragments"</code></div><div class="line number16 index15 alt1 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">Tensor tCrA = thr_mma.make_fragment_A(tCsA);&nbsp; </code><code class="cpp comments">// (MMA,MMA_M,MMA_K,PIPE)</code></div><div class="line number17 index16 alt2 highlighted"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">Tensor tCrB = thr_mma.make_fragment_B(tCsB);&nbsp; </code><code class="cpp comments">// (MMA,MMA_N,MMA_K,PIPE)</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code>&nbsp;</div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// PIPELINED MAIN LOOP</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code> <code class="cpp plain">(k_tile_count &gt; -K_PIPE_MAX) {</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// ...</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// MMAs to cover 1 K_TILE</code></div><div class="line number23 index22 alt2 highlighted"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cute::warpgroup_arrive();</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// (V,M,K) x (V,N,K) =&gt; (V,M,N)</code></div><div class="line number25 index24 alt2 highlighted"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cute::gemm(tiled_mma, tCrA(_,_,_,read_pipe), tCrB(_,_,_,read_pipe), tCrC);</code></div><div class="line number26 index25 alt1 highlighted"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cute::warpgroup_commit_batch();</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Wait for all MMAs in a K_TILE to complete</code></div><div class="line number28 index27 alt1 highlighted"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cute::warpgroup_wait&lt;0&gt;();</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// ...</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// EPILOGUE</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp comments">// ...</code></div><div class="line number34 index33 alt1"><code class="cpp plain">}</code></div></div></table></div></div></div>
<p>In the CUTLASS <a href=https://github.com/NVIDIA/cutlass/blob/main/media/docs/cute/0t_mma_atom.md data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/main/media/docs/cute/0t_mma_atom.md>paradigm for MMA</a>, the <code>cute::gemm</code> method is designed to expose architecture-specific MMA instructions via a uniform interface. (Indeed, if you examine the <a href=https://github.com/NVIDIA/cutlass/blob/main/examples/cute/tutorial/sgemm_sm80.cu#L275 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/main/examples/cute/tutorial/sgemm_sm80.cu#L275>SM80 tutorial GEMM kernel</a>, you’ll see that the <code>cute::gemm</code> call there is syntactically identical to that given above.) However, the definitions of the arguments involved in the <code>cute::gemm</code> call involve many WGMMA-specific aspects:</p>
<ul class=wp-block-list>
<li>The definition of the <code>TiledMMA</code> object <code>tiled_mma</code> encapsulates the information needed for <code>cute::gemm</code> to dispatch to a specific <code>wgmma</code> PTX instruction.</li>
<li>The layouts of the SMEM tensors <code>sA</code> and <code>sB</code> must be defined to be compatible with <code>wgmma</code>.</li>
<li>The fragments <code>tCrA</code>, <code>tCrB</code>, and <code>tCrC</code> are constructed as thread-level partitions of the data using the <code>TiledMMA</code> object, and as such have WGMMA-specific layouts that the programmer should be aware of.</li>
<li>The fragments <code>tCrA</code> (if sourcing operand <code>A</code> from SMEM) and <code>tCrB</code> aren’t register-backed tensors whose values are copied from SMEM, but rather matrix descriptors constructed on top of SMEM.</li>
</ul>
<p>Finally, of course there are the warpgroup synchronization primitives surrounding the <code>cute::gemm</code> call. We will explain all of these concepts in turn.</p>
<h3 class=wp-block-heading>TiledMMA object for WGMMA</h3>
<p>In what follows, suppose the datatype is FP16, and <code>A</code> and <code>B</code> are <code>MN</code>-major, so in BLAS notation we are computing a NT gemm. We construct the <code>TiledMMA</code> object on host using the <code>cute::make_tiled_mma</code> method as follows:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_730153 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp plain">TiledMMA tiled_mma = cute::make_tiled_mma(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">SM90_64x64x16_F16F16F16_SS&lt;GMMA::Major::MN,GMMA::Major::MN&gt;{});</code></div></div></table></div></div></div>
<p>Though <code>cute::make_tiled_mma</code> also has some optional arguments, let’s focus on the one at hand — the <em>MMA Atom</em>. This is a struct that wraps an underlying PTX call, which in this case is:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_980073 class="syntaxhighlighter nogutter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>wgmma.mma_async.sync.aligned.m64n64k16.f16.f16.f16</code></div></div></table></div></div></div>
<p>The CUTLASS notation is such that one can immediately read off the relationship between the wrapped PTX instruction and the MMA atom. Firstly, SM90 is a different name for the Hopper architecture. SM90 MMA atoms are then labeled as <code>SM90_MxNxK_XYZ_SS</code> or <code>SM90_MxNxK_XYZ_RS</code>, with two template parameters that can be either <code>GMMA::Major::MN</code> or <code>GMMA::Major::K</code>. Their meanings are as follows:</p>
<ul class=wp-block-list>
<li><code>X</code> and <code>Y</code> are the datatypes of the operands.</li>
<li><code>Z</code> is the datatype of the accumulator.</li>
<li><code>MxNxK</code> are the tile sizes that the <code>wgmma</code> instruction computes with — the “wgmma atom”. Not all values of <code>MxNxK</code> are possible. Here is the <a href=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-shape data-type=link data-id=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-shape>list of allowed shapes</a>: <code>M</code> is always 64, <code>N</code> is a multiple of 8 from 8 to 256, and for 16-bit operand datatype, <code>K</code> is 16 (more generally, <code>K</code> is fixed to be 32 bytes).</li>
<li>The suffix <code>RS</code> or <code>SS</code> indicates whether operand <code>A</code> is sourced from registers (<code>R</code>) or shared memory (<code>S</code>). Operand <code>B</code> is always sourced from shared memory, hence the <code>S</code>.</li>
<li>The two template parameters indicate whether operands <code>A</code> and <code>B</code> are memory-contiguous in the <code>MN</code> mode or <code>K</code> mode. For example, in BLAS notations, the operands both being <code>K</code>-major would correspond to a TN gemm (cf. <a href=https://github.com/NVIDIA/cutlass/blob/main/media/docs/cute/0x_gemm_tutorial.md#aside-m-major-n-major-k-major data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/main/media/docs/cute/0x_gemm_tutorial.md#aside-m-major-n-major-k-major>this table</a>). Note that for 16-bit operand datatypes, one has flexibility with the memory layouts being either <code>MN</code>-major or <code>K</code>-major. However, for non 16-bit operand datatypes, <strong>the layout must always be <code>K</code>-major</strong>.</li>
</ul>
<p>That’s it for the syntax you need to know for the MMA Atom! Now, we’ve emphasized that WGMMA is a <em>warpgroup-wide</em> instruction. In code, you can retrieve the number of threads participating in the MMA operation defined by the TiledMMA object using its <em>size</em>. For example, the following host code</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_446538 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp plain">dim3 dimBlock(cute::size(tiled_mma));</code></div></div></table></div></div></div>
<p>stipulates that each CTA in the kernel launches with 1 warpgroup of 128 threads.</p>
<p>Suppose instead that we wanted <em>2 warpgroups</em> to execute the WGMMA, with separate warpgroups computing halves of the output tile independently (and each issuing their individual <code>wgmma</code> instructions). To do this, we can pass a non-trivial layout (the <code>AtomLayoutMNK</code>) to the <code>make_tiled_mma</code> method as its second argument. For example, the following code</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_223430 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp plain">TiledMMA tiled_mma = make_tiled_mma(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp plain">SM90_64x64x16_F16F16F16_SS{},</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp plain">Layout&lt;Shape&lt;_2,_1,_1&gt;&gt;{});</code></div></div></table></div></div></div>
<p>defines a WGMMA operation where warpgroup 1 and 2 compute the upper and lower halves of the output tile as divided along the <code>M</code> mode (now assuming that <code>bM</code> is a multiple of 128). Moreover, <code>size(tiled_mma)</code> would then equal 256.</p>
<p>In general, the two optional layout arguments to <code>make_tiled_mma</code> — <code>AtomLayoutMNK</code> and <code>PermutationMNK</code> — work the same for any MMA Atom. For understanding the uses of <code>PermutationMNK</code>, we recommend Cris Cecka’s <a href=https://github.com/NVIDIA/cutlass/discussions/1345 data-type=link data-id=https://github.com/NVIDIA/cutlass/discussions/1345>excellent explanation</a>.</p>
<h3 class=wp-block-heading>SMEM layout constraints for WGMMA</h3>
<p>Next, we explain the constraints on the tile sizes and layouts for operand matrices in SMEM given the choice of MMA atom. First, as for any MMA instruction, the <code>MxNxK</code> of the MMA atom needs to divide into that of the operand and accumulator tiles. In our case, this means that <code>bM</code> should be a multiple of 64, <code>bN</code> a multiple of 64, and <code>bK</code> a multiple of 16.</p>
<p>Second, there is an additional constraint specifically imposed by WGMMA on the SMEM layouts for <code>sA</code> and <code>sB</code> (both shape and stride), and this constraint varies as a function of the chosen swizzling mode. In particular, the layout for (the stagewise slice of) <code>sA</code> is not simply <code>(bM,bK):(1,bM)</code> or <code>(bM,bK):(bK,1)</code> in general, and likewise for <code>sB</code>.</p>
<p>To understand these requirements in depth, one needs the concept of <em>core matrices</em>, which we will introduce below. However, as a practical matter, we can always construct layouts guaranteed to be compatible with <code>wgmma</code> using certain pre-defined layout atoms provided by CUTLASS, followed by the <code>cute::tile_to_shape</code> method. In our example, we prepare tile sizes and <code>sA</code>, <code>sB</code> on host as follows (with <code>T=cutlass::half_t</code> which is CUTLASS’s name for FP16):</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_474856 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp keyword bold">auto</code> <code class="cpp plain">bM = Int&lt;128&gt;{};</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">auto</code> <code class="cpp plain">bN = Int&lt;128&gt;{};</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">auto</code> <code class="cpp plain">bK = Int&lt; 64&gt;{};&nbsp; </code></div><div class="line number4 index3 alt1"><code class="cpp keyword bold">auto</code> <code class="cpp plain">bP = Int&lt;&nbsp; 3&gt;{};&nbsp; </code><code class="cpp comments">// Pipeline</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="cpp keyword bold">auto</code> <code class="cpp plain">sA = cute::tile_to_shape(</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GMMA::Layout_MN_SW128_Atom&lt;T&gt;{},</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cute::make_shape(bM, bK, bP)</code></div><div class="line number9 index8 alt2"><code class="cpp plain">);</code></div><div class="line number10 index9 alt1"><code class="cpp keyword bold">auto</code> <code class="cpp plain">sB = cute::tile_to_shape(</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GMMA::Layout_MN_SW128_Atom&lt;T&gt;{},</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">cute::make_shape(bN, bK, bP)</code></div><div class="line number13 index12 alt2"><code class="cpp plain">);</code></div></div></table></div></div></div>
<p>Here, <code>MN</code> indicates that the layout atom is suitable for <code>MN</code>-major operand, and <code>SW128</code> is the 128 byte swizzle mode. Printing out <code>sA</code> or <code>sB</code> displays</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_210986 class="syntaxhighlighter nogutter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>Sw&lt;3,4,3&gt; o smem_ptr[16b](unset) o ((_64,_2),(_8,_8),_3):((_1,_512),(_64,_1024),_8192)</code></div></div></table></div></div></div>
<p>Where does this layout come from? <code>cute::tile_to_shape</code> takes a layout (the eponymous tile) and replicates it to tile over a larger shape (akin to <code>numpy.tile</code>). Putting aside the swizzle function <code>Sw&lt;3,4,3&gt;</code>, we have that the layout atom is given by <code>(64,8):(1,64)</code> and is tiled over the shape <code>(128, 64, 3)</code> in <strong>column-major</strong> fashion, so for the <code>MxK</code> shape, the smaller outer stride of <code>512</code> lies in the <code>M</code> mode, while the larger outer stride of <code>1024</code> lies in the <code>K</code> mode. (The largest stride of <code>8192</code> lies in the stagecount <code>P</code> mode, which makes sense, since different stagewise slices of <code>sA</code> or <code>sB</code> shouldn’t be commingled in memory.)</p>
<p>Note that <code>64</code> times <code>sizeof(half_t)</code> equals 128 bytes, which is the swizzle mode’s name. This is by design: because of how core matrices work, we always arrange for the length of the layout atom in the contiguous direction to equal the number of swizzle bytes — either <code>16</code> for no-swizzle, or one of <code>32</code>, <code>64</code>, or <code>128</code>.</p>
<p>In contrast, if we considered:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_677628 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp keyword bold">auto</code> <code class="cpp plain">sA = cute::tile_to_shape(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">GMMA::Layout_K_SW128_Atom&lt;T&gt;{},</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">cute::make_shape(bM,bK,bP)</code></div><div class="line number4 index3 alt1"><code class="cpp plain">);</code></div><div class="line number5 index4 alt2"><code class="cpp keyword bold">auto</code> <code class="cpp plain">sB = cute::tile_to_shape(</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">GMMA::Layout_K_SW128_Atom&lt;T&gt;{},</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">cute::make_shape(bN,bK,bP)</code></div><div class="line number8 index7 alt1"><code class="cpp plain">);</code></div></div></table></div></div></div>
<p>then printing <code>sA</code> would give us</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_432646 class="syntaxhighlighter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>Sw&lt;3,4,3&gt; o smem_ptr[16b](unset) o (_128,_64,_3):(_64,_1,_8192)</code></div></div></table></div></div></div>
<p>since we instead tile <code>(8,64):(64,1)</code> over <code>(128,64,3)</code>. (Note that the layout <code>((_8,_16),(_64,_1),_3):((_64,_512),(_1,_0),_8192)</code> coalesces down to <code>(_128,_64,_3):(_64,_1,_8192)</code>).</p>
<p>In general, we can choose among <code>8</code> possibilities for layout atoms, which correspond to either <code>MN</code> or <code>K</code>-major and one of four swizzle modes:</p>
<ul class=wp-block-list>
<li>No swizzle: No swizzling. Implicit 16-byte boundary.</li>
<li>32-byte swizzle: Swizzling 2 consecutive 16-byte segments.</li>
<li>64-byte swizzle: Swizzling 4 consecutive 16-byte segments.</li>
<li>128-byte swizzle: Swizzling 8 consecutive 16-byte segments.</li>
</ul>
<p>The layout atoms are defined <a href=https://github.com/NVIDIA/cutlass/blob/36cbfcf483cc9d2ee65a55c199176ce96da1e33e/include/cute/atom/mma_traits_sm90_gmma.hpp#L66 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/36cbfcf483cc9d2ee65a55c199176ce96da1e33e/include/cute/atom/mma_traits_sm90_gmma.hpp#L66>here</a> in the CUTLASS codebase as:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_946435 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp plain">GMMA::Layout_MN_INTER_Atom&lt;T&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">GMMA::Layout_MN_SW32_Atom&lt;T&gt;</code></div><div class="line number3 index2 alt2"><code class="cpp plain">GMMA::Layout_MN_SW64_Atom&lt;T&gt;</code></div><div class="line number4 index3 alt1"><code class="cpp plain">GMMA::Layout_MN_SW128_Atom&lt;T&gt;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="cpp plain">GMMA::Layout_K_INTER_Atom&lt;T&gt;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">GMMA::Layout_K_SW32_Atom&lt;T&gt;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">GMMA::Layout_K_SW64_Atom&lt;T&gt;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">GMMA::Layout_K_SW128_Atom&lt;T&gt;</code></div></div></table></div></div></div>
<p>These layout atoms must then be passed into <code>tile_to_shape</code> with the SMEM shape for <code>sA</code> and <code>sB</code> given by <code>make_shape(bM,bK,bP)</code> or <code>make_shape(bN,bK,bP)</code>, with the modes of the shape given <strong>in that order</strong>, such that the tile sizes of the layout atoms divide into those of the larger SMEM shape. This is ultimately a constraint on the SMEM shape caused by the choice of swizzling mode, and is separate from the other constraint imposed by the MMA atom shape.</p>
<h3 class=wp-block-heading>WGMMA Fragments and Descriptors</h3>
<p>We’ve created the <code>TiledMMA</code> object and prepared accordingly the SMEM layouts on host. Now, on device we can use the <code>TiledMMA</code> object <code>tiled_mma</code> to construct the appropriate partitioned tensors to be passed into the <code>cute::gemm</code> call. First, we create a <code>ThrMMA</code> object called <code>thr_mma</code> by invoking the <code>get_thread_slice</code> method on <code>tiled_mma</code> with the thread index, which runs inclusively from <code>0</code> to <code>127</code> in our case.</p>
<p>Then, with reference to the kernel code snippet above, printing the tensors <code>tCsA</code> and <code>tCsB</code> <strong>for any thread index</strong> shows the following:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_430968 class="syntaxhighlighter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>tCsA: Sw&lt;3,4,3&gt;_smem_ptr[16b](0x7f8800000400) o</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class=plain>((_64,(_8,_2)),_2,_4,_3):((_1,(_64,_1024)),_512,_2048,_8192)</code></div><div class="line number3 index2 alt2"><code class=plain>tCsB: Sw&lt;3,4,3&gt;_smem_ptr[16b](0x7f880000c400) o</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class=plain>((_64,(_8,_2)),_2,_4,_3):((_1,(_64,_1024)),_512,_2048,_8192)</code></div></div></table></div></div></div>
<p>As per the comment, the shape of <code>tCsA</code> should be thought of as <code>(MMA,MMA_M,MMA_K,PIPE)</code>:</p>
<ul class=wp-block-list>
<li><code>MMA</code> is the <code>NxK</code> shape of the MMA Atom.</li>
<li><code>MMA_M</code> and <code>MMA_K</code> are the extents of its tiling across the <code>M</code> and <code>K</code> modes of <code>sA</code> (so that <code>MMA_M=bM/64=2</code> and <code>MMA_K=bK/16=4</code>).</li>
<li><code>PIPE</code> is the number of stages.</li>
</ul>
<p>The strides and swizzle mode carry over from <code>sA</code>. The WGMMA-specific thing to notice here is that <code>tCsA</code> isn’t actually a thread-level slice of SMEM, but rather the entire SMEM tensor with a reorganized layout.</p>
<p>Next, printing the “fragments” <code>tCrA</code> and <code>tCrB</code> for any thread index shows:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_244947 class="syntaxhighlighter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>tCrA: GMMA::DescriptorIterator o (_1,_2,_4,_3):(_0,_64,_256,_1024)</code></div><div class="line number2 index1 alt1"><code class=plain>tCrB: GMMA::DescriptorIterator o (_1,_2,_4,_3):(_0,_64,_256,_1024)</code></div></div></table></div></div></div>
<p>Internally, CUTLASS constructs a “<a href=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-shared-memory-layout-matrix-descriptor data-type=link data-id=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-shared-memory-layout-matrix-descriptor>matrix descriptor</a>“, which is 64-bit value held in registers that describes the SMEM in a way suitable for use by the <code>wgmma</code> instruction. For the programmer, the most important thing to bear in mind is that values of SMEM are <strong>not</strong> copied into RMEM; rather, accessing the values of <code>tCrA</code> and <code>tCrB</code> instead accesses these 64-bit descriptors. Moreover, these tensors being “iterators” means that only the single 64-bit descriptor used for a given <code>wgmma</code> instruction is held in registers at a time (e.g., as opposed to all 24 of them).</p>
<p>In contrast to the operands, the accumulator tensors are defined in a more standard fashion. Printing out <code>tCgC</code> and <code>tCrC</code> for thread 0 shows:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_824338 class="syntaxhighlighter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>tCgC: gmem_ptr[16b](0x7f877a780000) o ((_2,_2,_8),_2,_2):((512,_8,4096),_64,32768)</code></div><div class="line number2 index1 alt1"><code class=plain>tCrC: ptr[16b](0x7feee1fffbe0) o ((_2,_2,_8),_2,_2):((_1,_2,_4),_32,_64)</code></div></div></table></div></div></div>
<p><code>tCgC</code> is the slice of the output GMEM tensor that we want to copy the accumulator’s values to in the epilogue, and <code>tCrC</code> is the register-backed tensor created to hold these values as they are computed in the mainloop. The <code>(MMA,MMA_M,MMA_N)</code> shapes of these tensors can be interpreted as follows: in the MMA atom’s <code>MxN=64x64</code> output tile, each of the 128 threads holds <code>32=2*2*8</code> values, and <code>MMA_M=MMA_N=2</code> are the same as for <code>tCsA</code> and <code>tCsB</code>.</p>
<p>Each thread holds its 32 values of the atom in a way that necessitates factoring 32 as (2,2,8) for the shape in order to be able to define the corresponding strides for the layout of <code>tCgC</code>. The specific partitioning pattern can be read off from this picture taken <a href=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#wgmma-64n16-d data-type=link data-id=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#wgmma-64n16-d>from the PTX documentation</a>:</p>
<figure class="wp-block-image size-large is-resized"><img data-recalc-dims=1 decoding=async width=855 height=540 src="data:image/webp;base64,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" alt class=wp-image-12479 style=width:1000px srcset sizes></figure>
<p>This illustrates the replicated Z-pattern in which a thread’s 32 values are held. For example, thread 0 holds the values at (0,0), (0,1), (8,0), (8,1) and repeated every 8 columns to the right.</p>
<h3 class=wp-block-heading>The gemm call, revisited</h3>
<p>Let’s return to line 25 of the kernel code snippet above:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_188542 class="syntaxhighlighter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>// (V,M,K) x (V,N,K) =&gt; (V,M,N)</code></div><div class="line number2 index1 alt1"><code class=plain>cute::gemm(tiled_mma, tCrA(_,_,_,read_pipe), tCrB(_,_,_,read_pipe), tCrC);</code></div></div></table></div></div></div>
<p>The various overloads of the <code>cute::gemm</code> method serve to first loop over the outer modes <code>MMA_M/N</code> and <code>MMA_K</code>. Once those coordinates are chosen, we’re just computing with the MMA atom tile shape. Put another way, we first reduce to the overload of <code>cute::gemm</code> for the <a href=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/algorithm/gemm.hpp#L178 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/algorithm/gemm.hpp#L178>dispatch shape</a> <code>(V)x(V)=&gt;(V)</code>.</p>
<p>The code then invokes the <a href=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/arch/mma_sm90_gmma.hpp#L401 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/arch/mma_sm90_gmma.hpp#L401><code>fma</code> operation</a> of the MMA atom (precisely, within the <a href=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/atom/mma_traits.hpp#L112 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/atom/mma_traits.hpp#L112>mma_unpack</a> method). This contains the inline PTX assembly:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_437371 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><td class=code><div class=container><div class="line number1 index0 alt2"><code class="cpp plain">CUTE_HOST_DEVICE </code><code class="cpp keyword bold">static</code> <code class="cpp keyword bold">void</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">fma(</code><code class="cpp color1 bold">uint64_t</code> <code class="cpp keyword bold">const</code><code class="cpp plain">&amp; desc_a,</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint64_t</code> <code class="cpp keyword bold">const</code><code class="cpp plain">&amp; desc_b,</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d00, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d01, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d02, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d03,</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d04, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d05, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d06, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d07,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d08, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d09, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d10, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d11,</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d12, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d13, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d14, </code><code class="cpp color1 bold">uint32_t</code><code class="cpp plain">&amp; d15,</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GMMA::ScaleOut </code><code class="cpp keyword bold">const</code> <code class="cpp plain">scale_D = GMMA::ScaleOut::One)</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number10 index9 alt1"><code class="cpp preprocessor">#if defined(CUTE_ARCH_MMA_SM90A_ENABLED)</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">asm </code><code class="cpp keyword bold">volatile</code><code class="cpp plain">(</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"{\n"</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">".reg .pred p;\n"</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"setp.ne.b32 p, %18, 0;\n"</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"wgmma.mma_async.sync.aligned.m64n64k16.f16.f16.f16 "</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"{%0,&nbsp; %1,&nbsp; %2,&nbsp; %3,&nbsp; %4,&nbsp; %5,&nbsp; %6,&nbsp; %7,&nbsp; "</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">" %8,&nbsp; %9,&nbsp; %10, %11, %12, %13, %14, %15},"</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">" %16,"</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">" %17,"</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">" p,&nbsp;&nbsp; %19, %20, %21, %22;\n"</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"}\n"</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">: </code><code class="cpp string">"+r"</code><code class="cpp plain">(d00), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d01), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d02), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d03),</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"+r"</code><code class="cpp plain">(d04), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d05), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d06), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d07),</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"+r"</code><code class="cpp plain">(d08), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d09), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d10), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d11),</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"+r"</code><code class="cpp plain">(d12), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d13), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d14), </code><code class="cpp string">"+r"</code><code class="cpp plain">(d15)</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">: </code><code class="cpp string">"l"</code><code class="cpp plain">(desc_a),</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"l"</code><code class="cpp plain">(desc_b),</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"r"</code><code class="cpp plain">(</code><code class="cpp color1 bold">int32_t</code><code class="cpp plain">(scale_D)),</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"n"</code><code class="cpp plain">(</code><code class="cpp color1 bold">int32_t</code><code class="cpp plain">(scaleA)),</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"n"</code><code class="cpp plain">(</code><code class="cpp color1 bold">int32_t</code><code class="cpp plain">(scaleB)),</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"n"</code><code class="cpp plain">(</code><code class="cpp color1 bold">int32_t</code><code class="cpp plain">(tnspA)),</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"n"</code><code class="cpp plain">(</code><code class="cpp color1 bold">int32_t</code><code class="cpp plain">(tnspB)));</code></div><div class="line number33 index32 alt2"><code class="cpp preprocessor">#else</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CUTE_INVALID_CONTROL_PATH(</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"Attempting to use SM90_64x64x16_F16F16F16_SS "</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"without CUTE_ARCH_MMA_SM90A_ENABLED"</code><code class="cpp plain">);</code></div><div class="line number37 index36 alt2"><code class="cpp preprocessor">#endif</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">}</code></div></div></table></div></div></div>
<p>The corresponding PTX documentation for this syntax is <a href=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-instructions-wgmma-mma data-type=link data-id=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-instructions-wgmma-mma>here</a>. Consistent with the descriptions of the tensors <code>tCrA</code>, <code>tCrB</code>, and <code>tCrC</code> above, observe that we have the <code>uint64</code> variables <code>desc_a</code> and <code>desc_b</code> for the operands along with 16 <code>uint32</code> variables for the accumulator. <code>scale_D</code> is either <code>0</code> or <code>1</code>, and controls whether or not the accumulator is zero-initialized.</p>
<p>In addition, the variables <code>scaleA</code>, <code>scaleB</code>, <code>tnspA</code>, <code>tnspB</code> are determined at compile-time outside the <code>fma</code> method via template parameters. <code>scaleA</code> and <code>scaleB</code> are either 1 or -1 for negating the operand, while <code>tnspA</code> and <code>tnspB</code> indicate whether to transpose the operand, and are 0 or 1 for <code>GMMA::Major::K</code> or <code>GMMA::Major::MN</code>, respectively.</p>
<h3 class=wp-block-heading>Synchronization for WGMMA</h3>
<p>It remains to explain the synchronization primitives surrounding the <code>cute::gemm</code> call:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_6040 class="syntaxhighlighter cpp"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=gutter><div class="line number1 index0 alt2 highlighted">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2 highlighted">3</div><div class="line number4 index3 alt1 highlighted">4</div><td class=code><div class=container><div class="line number1 index0 alt2 highlighted"><code class="cpp plain">cute::warpgroup_arrive();</code></div><div class="line number2 index1 alt1"><code class="cpp plain">cute::gemm(tiled_mma, tCrA(_,_,_,read_pipe), tCrB(_,_,_,read_pipe), tCrC);</code></div><div class="line number3 index2 alt2 highlighted"><code class="cpp plain">cute::warpgroup_commit_batch();</code></div><div class="line number4 index3 alt1 highlighted"><code class="cpp plain">cute::warpgroup_wait&lt;0&gt;();</code></div></div></table></div></div></div>
<p>Why are these additional commands necessary at all? They have to do with <code>wgmma</code>‘s nature as an <em>asynchronous</em> instruction. In the context of the Hopper architecture, <em>asynchronous</em> indicates that <code>wgmma</code> can run concurrently with other operations, hence necessitating a synchronization mechanism for dependent steps. This mechanism is elaborated upon in the PTX <a href=https://docs.nvidia.com/cuda/archive/12.3.2/parallel-thread-execution/index.html#program-order-async-operations data-type=link data-id=https://docs.nvidia.com/cuda/archive/12.3.2/parallel-thread-execution/index.html#program-order-async-operations>memory consistency model</a>. Improper synchronization in code can result in (a) subtle race conditions, leading to challenging bugs, (b) the compiler serializing the <code>wgmma</code> instructions, which can cause significant performance degradation, or (c) undefined behavior.</p>
<p>The highlighted <code>cute</code> methods wrap the following PTX instructions:</p>
<ul class=wp-block-list>
<li><code>cute::warpgroup_arrive()</code> — <code>wgmma.fence.sync.aligned</code>;</li>
<li><code>cute::warpgroup_commit_batch()</code> — <code>wgmma.commit_group.sync.aligned</code>;</li>
<li><code>cute::warpgroup_wait&lt;N&gt;()</code> — <code>wgmma.wait_group.sync.aligned N</code>;</li>
</ul>
<p>(Note that we’ve been using <code>wgmma</code> as shorthand for <code>wgmma.mma_async</code> throughout, but in this subsection only we disambiguate this.) Let’s connect the usage of these commands to the following description of WGMMA-based GEMM taken verbatim from the <a href=https://docs.nvidia.com/cuda/archive/12.3.2/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-multiply-accumulate-instructions>PTX documentation</a>:</p>
<ol class=wp-block-list>
<li>Load matrices <code>A</code>, <code>B</code>, and <code>D</code> into registers or into shared memory.</li>
<li>Perform the following&nbsp;<code>fence</code>&nbsp;operations:
<ul class=wp-block-list>
<li><code>wgmma.fence</code>&nbsp;operations to indicate that the register/shared-memory across the warpgroup have been written into.</li>
<li><code>fence.proxy.async</code>&nbsp;operation to make the generic proxy operations visible to the async proxy.</li>
</ul>
</li>
<li>Issue the asynchronous matrix multiply and accumulate operations using the&nbsp;<code>wgmma.mma_async</code>&nbsp;operation on the input matrices. The&nbsp;<code>wgmma.mma_async</code>&nbsp;operation is performed in the async proxy.</li>
<li>Create a wgmma-group and commit all the prior outstanding&nbsp;<code>wgmma.mma_async</code>&nbsp;operations into the group, by using&nbsp;<code>wgmma.commit_group</code>&nbsp;operation.</li>
<li>Wait for the completion of the required wgmma-group using <code>wgmma.wait_group</code>.</li>
<li>Once the wgmma-group completes, all the&nbsp;<code>wgmma.mma_async</code>&nbsp;operations have been performed and completed.</li>
</ol>
<p>We explain these points in order. First, a <code>wgmma.fence</code>&nbsp;instruction ensures that <code>wgmma.mma_async</code> only accesses certain RMEM addresses after all prior accesses to such addresses have finished. Without the <code>wgmma.fence</code>, the behavior is undefined. An exception to this rule is that Hopper allows <em>multiple </em><code>wgmma.mma_async</code> instructions to be in flight simultaneously. As long as these <code>wgmma.mma_async</code> instructions have the same accumulator shape, they can share the same accumulator tensor, i.e., write to the same register memory addresses. In that case, a fence is not required. For example, we don’t need to insert a <code>wgmma.fence</code> within the loop over <code>MMA_K</code> done as part of the <code>cute::gemm</code> call.</p>
<p>Just like <a href=https://research.colfax-intl.com/tutorial-hopper-tma/>TMA operations</a>, <code>wgmma.mma_async</code> is performed in the <a href=https://docs.nvidia.com/cuda/parallel-thread-execution/#async-proxy>async proxy</a>. Hence, <em>if</em> operations performed in the generic proxy affect the SMEM read by <code>wgmma.mma_async</code>, we need to issue <code>fence.proxy.async</code>. For example, this would be the case if we copied <code>A</code> and <code>B</code> into SMEM via ordinary <code>ld.global</code> / <code>st.shared</code> operations. Since we use TMA load, we don’t need <code>fence.proxy.async</code> in our example, and indeed it doesn’t appear in the WGMMA tutorial code or in the mainloop of CUTLASS Hopper GEMM kernels. (To verify this, note that <code>fence.proxy.async</code> is wrapped by <code>cutlass::arch::fence_view_async_shared()</code>).</p>
<p>The <code>wgmma.commit_group</code>&nbsp;instruction creates a new wgmma-group per warpgroup and batches all prior&nbsp;<code>wgmma.mma_async</code>&nbsp;instructions initiated by the executing warpgroup but not committed to any wgmma-group into the new wgmma-group. In our example, <code>cute::warpgroup_commit_batch()</code> batches <code>MMA_M*MMA_N*MMA_K</code> many <code>wgmma.mma_async</code> instructions into one wgmma-group.</p>
<p>Finally, the <code>wgmma.wait_group</code>&nbsp;instruction with argument <code>N</code> will make the executing thread wait until only <code>N</code> or fewer of the most recent wgmma-groups are pending and all the prior wgmma-groups committed by the executing threads are complete. In our example, we let <code>N=0</code>, so the warpgroup simply waits for the completion of the entire wgmma-group before continuing to execute any subsequent instructions.</p>
<p>In situations where the warpgroup has the opportunity to perform independent computation, flexibility with the parameter <code>N</code> comes in handy. For example, this comes into play with the GEMM-softmax overlapping strategy employed in the design of <a href=https://research.colfax-intl.com/flashattention-3-fast-and-accurate-attention-with-asynchrony-and-low-precision/ data-type=link data-id=https://research.colfax-intl.com/flashattention-3-fast-and-accurate-attention-with-asynchrony-and-low-precision/>FlashAttention-3</a>.</p>
<h3 class=wp-block-heading>WGMMA core matrices</h3>
<p>This last section discusses further the layout requirements for tiles of matrices <code>A</code> and <code>B</code> loaded into SMEM, supposing that <code>wgmma</code> sources both of its operands from SMEM. To simplify the discussion, first suppose that <code>A</code> is row-major and <code>B</code> is column-major (i.e., both are <code>K</code>-major). Recall also that the <code>wgmma</code> instruction’s tile shape <code>MxNxK</code> is constrained so that <code>M</code> is 64, <code>K</code> times the size of the datatype is 32 bytes, and <code>N</code> is a multiple of 8 running from 8 to 256. To avoid confusion with <code>A</code>/<code>B</code> or <code>sA</code>/<code>sB</code>, let’s notate the WGMMA atom tiles as <code>wA</code> and <code>wB</code>.<br><br>The matrices <code>wA</code> and <code>wB</code> are divided into a number of smaller matrices called <em>core matrices.</em> Each core matrix has a <em>strided</em> direction and a <em>contiguous</em> direction, such that its length is 8 in the strided direction and 16 bytes in the contiguous direction. Matrix <code>wA</code> is made up of <code>8x2</code> core matrices and Matrix <code>wB</code> is made up of <code>2x(N/8)</code> core matrices. We illustrate a tiling of <code>wA</code> and <code>wB</code> by core matrices as follows (with images taken from the PTX documentation):</p>
<div class="wp-block-media-text is-stacked-on-mobile" style=grid-template-columns:68%auto><figure class=wp-block-media-text__media><img data-recalc-dims=1 decoding=async width=960 height=540 src="data:image/webp;base64,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" alt class="wp-image-11670 size-full" srcset sizes></figure><div class=wp-block-media-text__content>
<p class="has-text-align-center has-large-font-size">Layout of <code>wA</code> in SMEM</p>
</div></div>
<div class="wp-block-media-text is-stacked-on-mobile" style=grid-template-columns:69%auto><figure class=wp-block-media-text__media><img data-recalc-dims=1 loading=lazy decoding=async width=960 height=540 src="data:image/webp;base64,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" alt class="wp-image-11671 size-full" srcset sizes></figure><div class=wp-block-media-text__content>
<p class="has-text-align-center has-large-font-size">Layout of <code>wB</code> in SMEM</p>
</div></div>
<p>As mentioned above, <code>wgmma</code> in SS mode requires <a href=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-shared-memory-layout-matrix-descriptor data-type=link data-id=https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#asynchronous-warpgroup-level-matrix-shared-memory-layout-matrix-descriptor>matrix descriptors</a> for both <code>wA</code> (<code>desc-a</code>) and <code>wB</code> (<code>desc-b</code>) as inputs. This descriptor encodes five parameters:</p>
<ul class=wp-block-list>
<li>Start address: starting base address of the operand in SMEM.</li>
<li>LBO (<em>leading dimension byte offset</em>): the distance, in bytes, between two adjacent core matrices in the <code>K</code> dimension.</li>
<li>SBO (<em>stride dimension byte offset</em>): the distance, in bytes, between two adjacent core matrices in the <code>M</code> or <code>N</code> dimension.</li>
<li>Swizzling mode: none, 32, 64, or 128 bytes.</li>
<li>Matrix base offset: This is used to resolve SMEM alignment problems in case SMEM addresses are not aligned to the byte boundary of the repeating pattern for the swizzle mode.</li>
</ul>
<p>LBO and SBO are indicated in the figures above.</p>
<p>The <a href=https://github.com/NVIDIA/cutlass/blob/06b21349bcf6ddf6a1686a47a137ad1446579db9/include/cute/atom/mma_traits_sm90_gmma.hpp#L194C1-L194C54><code>make_gmma_desc</code></a> method in CUTLASS constructs the descriptor (as an instance of <code><a href=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/arch/mma_sm90_desc.hpp#L86 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/arch/mma_sm90_desc.hpp#L86>GmmaDescriptor</a></code>) based on the SMEM tensor’s layout provided as input. Provided that the input tensor’s layout is created using one of the eight canonical GMMA layout atoms and <code>tile_to_shape</code>, as previously detailed in “SMEM layout constraints for WGMMA”, <code>make_gmma_desc</code> will accurately calculate the LBO and SBO, determine the swizzling mode, and construct the descriptor. For example, the <code>GmmaDescriptor</code> describes the following admissible WGMMA layouts in the <code>K</code>-major case (where <code>T*sizeof(dtype)=16</code>):</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_918735 class="syntaxhighlighter nogutter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>No swizzle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Swizzle&lt;0,4,3&gt; o smem_ptr o ((8,m),(T,2)):((1T,SBO),(1,LBO))</code></div><div class="line number2 index1 alt1"><code class=plain>32-byte swizzle&nbsp; : Swizzle&lt;1,4,3&gt; o smem_ptr o ((8,m),(T,2)):((2T,SBO),(1, T ))</code></div><div class="line number3 index2 alt2"><code class=plain>64-byte swizzle&nbsp; : Swizzle&lt;2,4,3&gt; o smem_ptr o ((8,m),(T,2)):((4T,SBO),(1, T ))</code></div><div class="line number4 index3 alt1"><code class=plain>128-byte swizzle : Swizzle&lt;3,4,3&gt; o smem_ptr o ((8,m),(T,2)):((8T,SBO),(1, T ))</code></div></div></table></div></div></div>
<p>For the <a href=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/layout.hpp#L415 data-type=link data-id=https://github.com/NVIDIA/cutlass/blob/be60a0b27204078dc0f3f1d6ed4a95cdb2114111/include/cute/layout.hpp#L415><em>compact</em></a> layouts produced by the GMMA layout atom =&gt; <code>tile_to_shape</code> pattern (note the GMMA layout <code>K</code> atoms have a larger <code>K</code>-mode than the WGMMA atom shape in the case of 64 and 128-byte swizzle!), we have these corresponding values for LBO and SBO:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_410996 class="syntaxhighlighter nogutter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>No swizzle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : LBO = 16x8 = 128 bytes. SBO = 32x8 = 256 bytes.</code></div><div class="line number2 index1 alt1"><code class=plain>32-byte swizzle&nbsp; : SBO = 32x8 = 256 bytes.</code></div><div class="line number3 index2 alt2"><code class=plain>64-byte swizzle&nbsp; : SBO = 64x8 = 512 bytes.</code></div><div class="line number4 index3 alt1"><code class=plain>128-byte swizzle : SBO = 128x8 = 1024 bytes.</code></div></div></table></div></div></div>
<p>Most notably, for 64 and 128-byte swizzle, the strides are such that the given admissible WGMMA layouts are <strong>not</strong> compact. Rather, one has sets of 2 or 4 WGMMA atom operand tiles stacked side-by-side in the <code>K</code>-direction, resulting in strides of <code>4T</code> and <code>8T</code> for the core matrix <code>M</code>-mode. Put another way, when swizzling one interleaves in memory the 2, 4, or 8 core matrices logically adjacent in the <code>K</code>-mode, and these core matrices will belong to <em>different</em> WGMMA atoms for 64 and 128-byte swizzle.</p>
<p>For the sake of completeness, we also give the admissible WGMMA layouts in the <code>MN</code>-major case:</p>
<div class=wp-block-syntaxhighlighter-code><div><div id=highlighter_458589 class="syntaxhighlighter nogutter plain"><table border=0 cellpadding=0 cellspacing=0><tbody><tr><td class=code><div class=container><div class="line number1 index0 alt2"><code class=plain>No swizzle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Swizzle&lt;0,4,3&gt; o smem_ptr o ((T,1,m),(8,k)):((1,T,SBO),(1T,LBO))</code></div><div class="line number2 index1 alt1"><code class=plain>32-byte swizzle&nbsp; : Swizzle&lt;1,4,3&gt; o smem_ptr o ((T,2,m),(8,k)):((1,T,LBO),(2T,SBO))</code></div><div class="line number3 index2 alt2"><code class=plain>64-byte swizzle&nbsp; : Swizzle&lt;2,4,3&gt; o smem_ptr o ((T,4,m),(8,k)):((1,T,LBO),(4T,SBO))</code></div><div class="line number4 index3 alt1"><code class=plain>128-byte swizzle : Swizzle&lt;3,4,3&gt; o smem_ptr o ((T,8,m),(8,k)):((1,T,LBO),(8T,SBO))</code></div></div></table></div></div></div>
<h3 class=wp-block-heading>Conclusion</h3>
<p>In this [Part 1] of the GEMM series, we have covered the core concepts involved in using WGMMA (warpgroup matrix-multiply and accumulate) as a primitive in Hopper-based GEMM.</p>
<p>WGMMA requires a warpgroup — 128 threads — to collectively execute the matrix multiplication, and can only operate on certain fragments of matrices. We went into the special shapes and layouts involved in this, with an emphasis on how to construct operand layouts guaranteed to be accepted by WGMMA using the canonical GMMA Layout =&gt; <code>tile_to_shape</code> pattern.</p>
<p>For its usage to be well-defined, WGMMA also requires certain synchronization mechanisms. To this end, we explained the uses of <code>wgmma.fence</code>, <code>fence.proxy.async</code>, <code>wgmma.commit_group</code> and <code>wgmma.wait_group</code> in relation to <code>wgmma.mma_async</code>.</p>
<p>Lastly, we explained in some detail the inner workings of WGMMA core matrices and how CUTLASS constructs matrix descriptors for those operands sourced from SMEM.</p>
<p>Taken as a whole, this blog post should enable the programmer to write CUTLASS kernels on Hopper that use WGMMA. In [Part 2], we will extend this discussion to incorporate TMA, and how to use TMA and WGMMA in tandem in a Hopper GEMM kernel so as to overlap copy and compute.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class=sd-title>Share this:</h3><div class=sd-content><ul data-sharing-events-added=true><li class=share-linkedin><a rel="nofollow noopener noreferrer" data-shared=sharing-linkedin-11566 class="share-linkedin sd-button share-icon" href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?share=linkedin&amp;nb=1" target=_blank title="Click to share on LinkedIn"><span>LinkedIn</span></a><li class=share-twitter><a rel="nofollow noopener noreferrer" data-shared=sharing-twitter-11566 class="share-twitter sd-button share-icon" href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?share=twitter&amp;nb=1" target=_blank title="Click to share on Twitter"><span>Twitter</span></a><li class=share-facebook><a rel="nofollow noopener noreferrer" data-shared=sharing-facebook-11566 class="share-facebook sd-button share-icon" href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?share=facebook&amp;nb=1" target=_blank title="Click to share on Facebook"><span>Facebook</span></a><li class=share-reddit><a rel="nofollow noopener noreferrer" data-shared class="share-reddit sd-button share-icon" href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?share=reddit&amp;nb=1" target=_blank title="Click to share on Reddit"><span>Reddit</span></a><li class=share-end></ul></div></div></div></div><div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style=margin-top:48px;margin-bottom:48px;padding-top:5px;padding-bottom:5px>
 
 <hr class="wp-block-separator has-alpha-channel-opacity is-style-wide" style=margin-bottom:36px>
 
 
 <h3 class="wp-block-heading has-text-align-center" style=margin-top:4px;margin-bottom:10px>Discover more from Colfax Research</h3>
 
 
 <p class=has-text-align-center style="margin-top:4px;margin-bottom:0px;font-size:clamp(14px,0.875rem + ((1vw - 3.2px)*0.114),15px)">Subscribe to get the latest posts sent to your email.</p>
 
 
 <div class="wp-block-group has-global-padding is-layout-constrained wp-container-core-group-is-layout-8 wp-block-group-is-layout-constrained">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
 <div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
 <form action=https://wordpress.com/email-subscriptions method=post accept-charset=utf-8 data-blog=229326778 data-post_access_level=everybody data-subscriber_email id=subscribe-blog>
 <div class=wp-block-jetpack-subscriptions__form-elements>
 <p id=subscribe-email>
 <label id=subscribe-field-label for=subscribe-field class=screen-reader-text>
 Type your email… </label>
 <input required type=email name=email class=no-border-radius style="font-size:16px;padding:15px 23px 15px 23px;border-radius:0px;border-width:1px" placeholder="Type your email…" value id=subscribe-field title="Please fill in this field."> </p>
 <p id=subscribe-submit>
 
 
 
 
 
 
 
 <button type=submit class="wp-block-button__link no-border-radius" style="font-size:16px;padding:15px 23px 15px 23px;margin:0;margin-left:10px;border-radius:0px;border-width:1px" name=jetpack_subscriptions_widget>
 Subscribe <span class="jetpack-memberships-spinner sf-hidden">	<svg width=24 height=24 viewBox="0 0 24 24" xmlns=http://www.w3.org/2000/svg> <path d=M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z opacity=.25 fill=currentColor></path> <path d=M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z class=jetpack-memberships-spinner-rotating fill=currentColor></path>	</svg></span></button>
 </p>
 </div>
 </form>
 </div>
 </div>
 </div>
 
</div>
<div class=wp-block-template-part>
<div style=height:0 aria-hidden=true class=wp-block-spacer></div>
<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style=margin-top:var(--wp--preset--spacing--70)>
<div class="wp-block-columns alignwide has-small-font-size is-layout-flex wp-container-core-columns-is-layout-1 wp-block-columns-is-layout-flex" style=margin-top:var(--wp--preset--spacing--30)>
<div class="wp-block-column is-layout-flow wp-container-core-column-is-layout-1 wp-block-column-is-layout-flow">
<div class="wp-block-group is-layout-flex wp-container-core-group-is-layout-10 wp-block-group-is-layout-flex">
<p>
 Posted </p>
<div class=wp-block-post-date><time datetime=2024-08-06T09:33:04-07:00>August 6, 2024</time></div>
<p>
 in </p>
<div class="taxonomy-category wp-block-post-terms"><a href=https://research.colfax-intl.com/category/article/ rel=tag>Article</a><span class=wp-block-post-terms__separator>, </span><a href=https://research.colfax-intl.com/category/blog/ rel=tag>Blog</a><span class=wp-block-post-terms__separator>, </span><a href=https://research.colfax-intl.com/category/papers/tutorials/ rel=tag>Tutorials</a></div></div>
</div>
</div>
</div>
</div>
<section class=wp-block-template-part>
<div class="wp-block-group has-global-padding is-layout-constrained wp-container-core-group-is-layout-18 wp-block-group-is-layout-constrained" style=padding-top:var(--wp--preset--spacing--40);padding-right:var(--wp--preset--spacing--40);padding-bottom:var(--wp--preset--spacing--40);padding-left:var(--wp--preset--spacing--40)>
<div class=wp-block-comments>
<h2 class=wp-block-heading>Comments</h2>
<h4 id=comments class="wp-block-comments-title has-medium-font-size">6 responses to “CUTLASS Tutorial: Fast Matrix-Multiplication with WGMMA on NVIDIA® Hopper™ GPUs”</h4>
<ol class=wp-block-comment-template><li id=comment-230 class="comment even thread-even depth-1">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-2 wp-block-columns-is-layout-flex" style=margin-bottom:var(--wp--preset--spacing--40)>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style=flex-basis:40px><div class=wp-block-avatar><img alt="Iurii Avatar" src=data:image/jpeg;base64,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 srcset class="avatar avatar-40 photo wp-block-avatar__image" height=40 width=40 style=border-radius:20px loading=lazy decoding=async sizes></div></div>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"><div class=wp-block-comment-author-name><a rel="external nofollow ugc" href=https://www.linkedin.com/in/yurii-cobain target=_self>Iurii</a></div>
<div class="wp-block-group is-layout-flex wp-block-group-is-layout-flex" style=margin-top:0px;margin-bottom:0px><div class=wp-block-comment-date><time datetime=2024-09-28T09:24:18-07:00><a href=#comment-230>September 28, 2024</a></time></div>
</div>
<div class=wp-block-comment-content><p>Hi,</p>
<p>Thanks for really advanced and excellent series of blog posts.<br>
The technical part and details of this post are great. However the main outcome such as motivation to use TMA and WGMMA in terms of performance are missed. Especially comparison between A100 and H100 hw capabilities and maximum utilization of them.</p>
</div>
<div class=wp-block-comment-reply-link><a rel=nofollow class=comment-reply-link href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?replytocom=230#respond" data-commentid=230 data-postid=11566 data-belowelement=comment-230 data-respondelement=respond data-replyto="Reply to Iurii" aria-label="Reply to Iurii">Reply</a></div></div>
</div>
<ol><li id=comment-231 class="comment odd alt depth-2">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-3 wp-block-columns-is-layout-flex" style=margin-bottom:var(--wp--preset--spacing--40)>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style=flex-basis:40px><div class=wp-block-avatar><img alt="Hieu Pham Avatar" src=data:image/jpeg;base64,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 srcset class="avatar avatar-40 photo wp-block-avatar__image" height=40 width=40 style=border-radius:20px loading=lazy decoding=async sizes></div></div>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"><div class=wp-block-comment-author-name>Hieu Pham</div>
<div class="wp-block-group is-layout-flex wp-block-group-is-layout-flex" style=margin-top:0px;margin-bottom:0px><div class=wp-block-comment-date><time datetime=2024-09-28T17:26:30-07:00><a href=#comment-231>September 28, 2024</a></time></div>
</div>
<div class=wp-block-comment-content><p>Hi,</p>
<p>Thank you for your interest in this series.</p>
<p>If you want to see real performance gains as motivation, you need to refer to much more serious and technical work. For instance, Jay Shah, a co-author of this series, is the first author of Flash Attention 3. FA3 is an H100-specific kernel, making heavy use of TMA, WGMMA, and warp-specialized pipelines, which are all the concepts we have been discussing. Compared to that, FA2 is an A100-specific kernel, making heavy use of cp_async, WMMA, and multi-stage pipelined kernels. Their performance difference (2x – 3x?), is the evidence for H100 vs. A100.</p>
<p>Now, we cannot make *each* blogpost becomes an FA3. FA3 took 6 very smart and experienced people 5 months of continuous work to complete, give or take.</p>
<p>You should think of this series as a “how to” guide to study each techniques in FA3. If you learn all of them, and you apply them correctly, you can make the FA3 for your favorite kernel.</p>
</div>
<div class=wp-block-comment-reply-link><a rel=nofollow class=comment-reply-link href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?replytocom=231#respond" data-commentid=231 data-postid=11566 data-belowelement=comment-231 data-respondelement=respond data-replyto="Reply to Hieu Pham" aria-label="Reply to Hieu Pham">Reply</a></div></div>
</div>
</ol><li id=comment-232 class="comment even thread-odd thread-alt depth-1">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-4 wp-block-columns-is-layout-flex" style=margin-bottom:var(--wp--preset--spacing--40)>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style=flex-basis:40px><div class=wp-block-avatar><img alt="Elliot Gorokhovsky Avatar" src=data:image/jpeg;base64,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 srcset class="avatar avatar-40 photo wp-block-avatar__image" height=40 width=40 style=border-radius:20px loading=lazy decoding=async sizes></div></div>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"><div class=wp-block-comment-author-name>Elliot Gorokhovsky</div>
<div class="wp-block-group is-layout-flex wp-block-group-is-layout-flex" style=margin-top:0px;margin-bottom:0px><div class=wp-block-comment-date><time datetime=2024-10-07T07:29:42-07:00><a href=#comment-232>October 7, 2024</a></time></div>
</div>
<div class=wp-block-comment-content><p>Nit: there is a typo in the conclusion section. Should be fence.proxy.async, not fence.async.proxy.</p>
</div>
<div class=wp-block-comment-reply-link><a rel=nofollow class=comment-reply-link href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?replytocom=232#respond" data-commentid=232 data-postid=11566 data-belowelement=comment-232 data-respondelement=respond data-replyto="Reply to Elliot Gorokhovsky" aria-label="Reply to Elliot Gorokhovsky">Reply</a></div></div>
</div>
<ol><li id=comment-237 class="comment byuser comment-author-ryo odd alt depth-2">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-5 wp-block-columns-is-layout-flex" style=margin-bottom:var(--wp--preset--spacing--40)>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style=flex-basis:40px><div class=wp-block-avatar><img alt="Ryo Avatar" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' srcset class="avatar avatar-40 photo wp-block-avatar__image" height=40 width=40 style="border-radius:20px;background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-10)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" loading=lazy decoding=async sizes></div></div>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"><div class=wp-block-comment-author-name>Ryo</div>
<div class="wp-block-group is-layout-flex wp-block-group-is-layout-flex" style=margin-top:0px;margin-bottom:0px><div class=wp-block-comment-date><time datetime=2024-10-18T16:52:16-07:00><a href=#comment-237>October 18, 2024</a></time></div>
</div>
<div class=wp-block-comment-content><p>Thank you! Fixed.</p>
</div>
<div class=wp-block-comment-reply-link><a rel=nofollow class=comment-reply-link href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?replytocom=237#respond" data-commentid=237 data-postid=11566 data-belowelement=comment-237 data-respondelement=respond data-replyto="Reply to Ryo" aria-label="Reply to Ryo">Reply</a></div></div>
</div>
</ol><li id=comment-233 class="comment even thread-even depth-1">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-6 wp-block-columns-is-layout-flex" style=margin-bottom:var(--wp--preset--spacing--40)>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style=flex-basis:40px><div class=wp-block-avatar><img alt="A.L Avatar" src=data:image/jpeg;base64,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 srcset class="avatar avatar-40 photo avatar-default wp-block-avatar__image" height=40 width=40 style=border-radius:20px loading=lazy decoding=async sizes></div></div>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"><div class=wp-block-comment-author-name>A.L</div>
<div class="wp-block-group is-layout-flex wp-block-group-is-layout-flex" style=margin-top:0px;margin-bottom:0px><div class=wp-block-comment-date><time datetime=2024-10-09T20:50:56-07:00><a href=#comment-233>October 9, 2024</a></time></div>
</div>
<div class=wp-block-comment-content><p>Hi, </p>
<p>Wondering if wgmma or a warpgroup w/ 4 warps has to be dispatched and executed in the same EU’s tensor core?<br>
Before the concept of “warpgroup” is introduced, think the warp scheduler could schedule one warp to each EU then move to the next EU. So there could be two possible scenarios:<br>
A) warpgroup w/ 4 warps executed in 1 EU<br>
B) warpgroup w/ 4 warps in 4 EUs, 1 warp executed in 1 EU<br>
In both cases, 4 warps can be executed in lock-step style to achieve wgmma.<br>
Not sure which way is hopper using?</p>
</div>
<div class=wp-block-comment-reply-link><a rel=nofollow class=comment-reply-link href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?replytocom=233#respond" data-commentid=233 data-postid=11566 data-belowelement=comment-233 data-respondelement=respond data-replyto="Reply to A.L" aria-label="Reply to A.L">Reply</a></div></div>
</div>
<ol><li id=comment-238 class="comment byuser comment-author-ryo odd alt depth-2">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-7 wp-block-columns-is-layout-flex" style=margin-bottom:var(--wp--preset--spacing--40)>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style=flex-basis:40px><div class=wp-block-avatar><img alt="Ryo Avatar" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' srcset class="avatar avatar-40 photo wp-block-avatar__image" height=40 width=40 style="border-radius:20px;background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-10)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" loading=lazy decoding=async sizes></div></div>
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"><div class=wp-block-comment-author-name>Ryo</div>
<div class="wp-block-group is-layout-flex wp-block-group-is-layout-flex" style=margin-top:0px;margin-bottom:0px><div class=wp-block-comment-date><time datetime=2024-10-18T17:41:31-07:00><a href=#comment-238>October 18, 2024</a></time></div>
</div>
<div class=wp-block-comment-content><p>Sorry, I do not know the answer to this one. Some of the hardware details, especially around execution pipelines, seem to be proprietary and there aren’t documentations on them (to the best of our knowledge). That said, there are 4 Tensor Cores per SM. So if the answer is A then there needs to be minimum 4 warpgroups or 16 warps per SM (out of 64 possible) constantly assigned to WGMMA in order to saturate the Tensor Cores. And of course in a realistic scenario with TMA loads etc. you need a lot higher occupancy to actually saturate the Tensor Cores. And from (admittedly anecdotal) experience we didn’t need occupancy this high in order to saturate the Tensor Cores. So my guess is that the answer is B, where the warps are split among Tensor Cores. But again, please take this answer with a grain of salt.</p>
</div>
<div class=wp-block-comment-reply-link><a rel=nofollow class=comment-reply-link href="https://research.colfax-intl.com/cutlass-tutorial-wgmma-hopper/?replytocom=238#respond" data-commentid=238 data-postid=11566 data-belowelement=comment-238 data-respondelement=respond data-replyto="Reply to Ryo" aria-label="Reply to Ryo">Reply</a></div></div>
</div>
</ol></ol>
 <div id=respond class="comment-respond wp-block-post-comments-form">
 <h3 id=reply-title class=comment-reply-title>Leave a Reply <small><a rel=nofollow id=cancel-comment-reply-link href=#respond style=display:none>Cancel reply</a></small></h3><form action=https://research.colfax-intl.com/wp-comments-post.php method=post id=commentform class=comment-form novalidate><p class=comment-notes><span id=email-notes>Your email address will not be published.</span> <span class=required-field-message>Required fields are marked <span class=required>*</span></span><p class=comment-form-comment><label for=comment>Comment <span class=required>*</span></label> <textarea id=comment name=comment cols=45 rows=8 maxlength=65525 required value></textarea><p class=comment-form-author><label for=author>Name</label> <input id=author name=author type=text value size=30 maxlength=245 autocomplete=name></p>
<p class=comment-form-email><label for=email>Email</label> <input id=email name=email type=email value size=30 maxlength=100 aria-describedby=email-notes autocomplete=email></p>
<p class=comment-form-url><label for=url>Website</label> <input id=url name=url type=url value size=30 maxlength=200 autocomplete=url></p>
<p class=comment-form-cookies-consent><input id=wp-comment-cookies-consent name=wp-comment-cookies-consent type=checkbox value=yes> <label for=wp-comment-cookies-consent>Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit wp-block-button"><input name=submit type=submit id=submit class="wp-block-button__link wp-element-button" value="Post Comment"> 
<p style=display:none><p style=display:none!important class=akismet-fields-container data-prefix=ak_></p></form>	</div>
 </div>
</div>
</section></main>
<footer class=wp-block-template-part>
<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group alignwide is-content-justification-space-between is-layout-flex wp-container-core-group-is-layout-20 wp-block-group-is-layout-flex" style=padding-top:var(--wp--preset--spacing--40)>
<p class=has-small-font-size>Copyright © 2023-2024 Colfax International. All rights reserved.</p>
</div>
</div>
</footer></div>
 
 
<img src=data:, alt width=6 height=5 id=wpstats class=sf-hidden>
